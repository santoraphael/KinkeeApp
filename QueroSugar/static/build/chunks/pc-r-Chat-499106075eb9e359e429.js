/*! {Â© 2016 - 2020 Tinder, Inc., ALL RIGHTS RESERVED} */
(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{1153:function(e,t,a){"use strict";a.d(t,"b",(function(){return f})),a.d(t,"a",(function(){return v})),a.d(t,"c",(function(){return b}));var s=a(1),n=a.n(s),r=a(12),i=a(6),o=a.n(i),c=a(98),d=a(15),l=a(84),p=a(331);function u(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function h(e,t,a){var s=t.matchId,i=t.tempMessageId;return e.update(s,(function(e){return e.map((function(e){return e.get("_id")===i?e.merge(Object(r.fromJS)(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?u(Object(a),!0).forEach((function(t){n()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):u(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},t,{},a))):e}))}))}function g(e,t,a){return h(e,t,{state:a})}function m(e,t){var a=o()(t,["result","matches"]);return a?e.withMutations((function(e){a.forEach((function(a){var s=e.get(a);if(s&&0!==s.size){var n=t.entities.matches[a].messages,r=s.filter((function(e){return e.get("state")!==f||n.indexOf(e.get("_id"))<0}));e.set(a,r)}}))})):e}var f="success",v="failure",b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p.messages,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case l.j:return m(e,t.payload.data);case c.SEND_MESSAGE:var a=t.payload.messageData,s=a.matchId,n=new Date,i={_id:a.tempMessageId,match_id:s,to:"",from:a.userId,message:a.message,sent_date:n.toISOString(),created_date:n.toISOString(),timestamp:n.getTime(),state:"sending"};return i.type=a.type,a.gif_id&&(i.gif_id=a.gif_id),"song"===a.type&&(i.song=a.song),"contact_card"===a.type&&(i.contact_card=a.contact_card),e.update(s,(function(e){return(e||new r.List).push(Object(r.fromJS)(i))}));case c.SEND_MESSAGE_RETRY:var o=t.payload.messageData;return g(e,o,"sending");case c.SEND_MESSAGE_SUCCESS:var u=t.payload,b=u.messageData,y=u.response;return h(e,b,{state:f,_id:y._id});case c.SEND_MESSAGE_FAILURE:var I=t.payload.messageData;return g(e,I,v);case c.DELETE_TEMP_MESSAGE:var O=t.payload,M=O.matchId,k=O.tempMessageId;return e.update(M,(function(e){return e.filter((function(e){return e.get("_id")!==k}))}));case Object(d.r)(t.type):return p.messages;default:return e}}},1261:function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return n}));var s="chat/START_SESSION",n="chat/END_SESSION"},1262:function(e,t,a){"use strict";var s=a(7),n=a.n(s),r=a(16),i=a.n(r),o=a(26),c=a.n(o),d=a(24),l=a.n(d),p=a(23),u=a.n(p),h=a(19),g=a.n(h),m=a(27),f=a.n(m),v=a(1),b=a.n(v),y=a(5),I=a(37),O=a(58),M=a(461),k=a(1232),S=a(1157),x=a(1203),P=a(297),C=a(4),R=a(21),j=(function(e){function t(e){var a;return i()(this,t),a=l()(this,u()(t).call(this,e)),b()(g()(a),"handleClose",(function(){a.props.onProfileCardClose(a.props.currentOpenedRecProfile,a.state.activePhotoIndex)})),b()(g()(a),"handleGamePadClickLike",(function(){var e=a.props.currentOpenedRecProfile,t=a.state.activePhotoIndex,s=e.getIn(["photos",t]),n=s?s.get("id",""):"";a.props.onLike(e,n)})),b()(g()(a),"handleGamePadClickDislike",(function(){a.props.onDislike(a.props.currentOpenedRecProfile)})),b()(g()(a),"handleGamePadClickSuperlike",(function(){a.props.onSuperlike(a.props.currentOpenedRecProfile)})),b()(g()(a),"handlePhotoChange",(function(e){a.setState({activePhotoIndex:e})})),a.state={activePhotoIndex:e.currentOpenedRecProfile.get("activePhotoIndex")||0},a}return f()(t,e),c()(t,[{key:"componentDidMount",value:function(){var e=this.props.currentOpenedRecProfile;e&&this.props.trackEvent(C.Ob,{otherId:e.get("id")})}},{key:"componentWillUnmount",value:function(){var e=this.props.currentOpenedRecProfile;e&&this.props.trackEvent(C.Nb,{otherId:e.get("id")})}},{key:"render",value:function(){var e=this.props,t=e.backLinkUrl,a=e.className,s=e.currentOpenedRecProfile,r=e.loggedInUserSchools,i=e.loggedInUserJobs,o=e.loggedInUserGender,c=Object(P.c)(s);return n()("div",{className:Object(I.a)("CenterAlign Fld(c) H(100%) Pos(a) T(0) W(100%)",a)},void 0,n()(M.a,{},void 0,n()(k.a,{className:"Bdf($overlay-blur)",onClick:this.handleClose,opacity:.85})),n()("div",{className:"Mt(15px)--ml Mb(92px)--ml NetMaxHeight(100vh,130px)!--ml Expand--s"},void 0,n()(S.a,{loggedInUserSchools:r,loggedInUserJobs:i,loggedInUserGender:o,recUser:s,isVerified:Object(P.d)(s),isBoostMatch:Object(P.a)(s),isSuperBoostMatch:Object(P.b)(s),isSuperLike:c,anthem:Object(P.g)(s),artists:Object(P.h)(s),onClose:this.handleClose,onReported:this.handleGamePadClickDislike,onPhotoChange:this.handlePhotoChange,backLinkUrl:t,gamepadPosition:x.a.underCard,isProfileCardOverlay:!0,showGamepad:!0,recLike:this.handleGamePadClickLike,recDislike:this.handleGamePadClickDislike,recSuperlike:this.handleGamePadClickSuperlike})))}}]),t})(y.PureComponent),w={trackEvent:R.a};t.a=Object(O.c)(null,w)(j)},1263:function(e,t,a){"use strict";a.d(t,"b",(function(){return d})),a.d(t,"a",(function(){return l}));var s=a(1),n=a.n(s),r=a(168),i=a(2);function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){n()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var d=Object(i.a)("UPDATE_PROFILE_ENTITY_ACTIVE_PHOTO",(function(e,t){return p(e,{activePhotoIndex:t})})),l=Object(i.a)("UPDATE_PROFILE_ENTITY_CONFIRMED_STATUS",(function(e,t){return p(e,{confirmedStatus:t})})),p=function(e,t){return{entities:n()({},r.b,n()({},e.get("id"),c({},e.toJS(),{},t)))}}},1264:function(e,t,a){"use strict";a.d(t,"c",(function(){return i})),a.d(t,"b",(function(){return o})),a.d(t,"a",(function(){return c}));var s=a(3),n=a(2),r=Object(n.d)("spotify"),i=Object(s.a)(r,(function(e){return e.getIn(["searchedSongs","songs"])})),o=Object(s.a)(r,(function(e){return e.getIn(["searchedSongs","error"],!1)})),c=Object(s.a)(r,(function(e){return e.getIn(["popularSongs","songs"],!1)}))},1298:function(e,t,a){"use strict";var s=a(7),n=a.n(s),r=a(16),i=a.n(r),o=a(26),c=a.n(o),d=a(24),l=a.n(d),p=a(23),u=a.n(p),h=a(19),g=a.n(h),m=a(27),f=a.n(m),v=a(1),b=a.n(v),y=a(5),I=a(37),O=a(247),M=a(46),k=a.n(M),S=a(451),x=a.p+"5a2a86e4b74e33e4f0986ee06ac4aa8d.svg",P=a(1147),C=a(449),R=a(1144),j=n()(P.a,{className:"Sq(12px)"}),w=(function(e){function t(){var e,a;i()(this,t);for(var s=arguments.length,n=new Array(s),r=0;r<s;r++)n[r]=arguments[r];return a=l()(this,(e=u()(t)).call.apply(e,[this].concat(n))),b()(g()(a),"setAsActiveItem",(function(e){e.stopPropagation();var t=a.props,s=t.index,n=t.vinylObject;a.props.setAsActive(n,s)})),b()(g()(a),"handleSendVinyl",(function(e){e.stopPropagation();var t=a.props,s=t.index,n=t.vinylObject;a.props.onSend(n,s)})),b()(g()(a),"handleSongPlay",(function(){var e=a.props,t=e.index,s=e.vinylObject;a.props.onSongPlay(s,t)})),b()(g()(a),"handleSongStop",(function(e){var t=a.props,s=t.index,n=t.vinylObject;a.props.onSongStop(n,s,e)})),b()(g()(a),"handleAlbumArtLoaded",(function(){var e=a.props.index;a.props.onLoaded(e)})),a}return f()(t,e),c()(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.isActive,s=t.vinylObject,r=t.simple,i=t.intl,o=s.get("name"),c=s.getIn(["artists",0,"name"]);return n()("div",{className:Object(I.a)("D(f) Cur(p)",{"Mx(10px)--ml Mx(4px) Fld(c) W(136px)--ml W(68px)":!r,"P(16px) BdB Bdbc($c-divider)":r})},void 0,n()("div",{className:Object(I.a)({"H(136px)--ml H(68px)":!r,"H(40px) W(40px)":r}),onClick:this.setAsActiveItem,onKeyDown:function(t){return Object(S.a)(t.keyCode,!1)&&e.setAsActiveItem(t)},tabIndex:"0"},void 0,r?n()(C.a,{deferLoadUntilInViewport:!0,urls:[s.getIn(["album","images",0,"url"])],alt:i.formatMessage({id:"Anthem.songArt"}),width:40,height:40}):n()(R.b,{className:"H(100%)",onAlbumArtLoaded:this.handleAlbumArtLoaded,track:s,template:R.a.vinylDrawerItem,isActive:a,onPlaySong:this.handleSongPlay,onPauseSong:this.handleSongStop})),n()("div",{className:Object(I.a)("Fld(c) Mt(4px) Lh(n)",{"Mstart(15px)":r,"H(32px) CenterAlign":!r})},void 0,a?n()("button",{className:"P(0) Bd(0)",onClick:this.handleSendVinyl},void 0,n()("img",{src:x,alt:i.formatMessage({id:"send"})})):n()(y.Fragment,{},void 0,n()("div",{className:Object(I.a)("Mb(4px) Fz($2xs)--s",{Ell:!r})},void 0,o),n()("div",{className:Object(I.a)("Fz($2xs)--ml Pb(4px)--s Fz($3xs)",{Ell:!r})},void 0,r?n()(y.Fragment,{},void 0,j," ",c):c))))}}]),t})(y.PureComponent);w.defaultProps={onLoaded:k.a,setAsActive:k.a};t.a=Object(O.c)(w)},1499:function(e,t,a){"use strict";a.r(t),a.d(t,"DRAWER_DIRECTIONS",(function(){return bn}));var s=a(70),n=a.n(s),r=a(42),i=a.n(r),o=a(7),c=a.n(o),d=a(16),l=a.n(d),p=a(26),u=a.n(p),h=a(24),g=a.n(h),m=a(23),f=a.n(m),v=a(19),b=a.n(v),y=a(27),I=a.n(y),O=a(1),M=a.n(O),k=a(5),S=a.n(k),x=a(243),P=a.n(x),C=a(158),R=a.n(C),j=a(191),w=a.n(j),E=a(58),N=a(296),T=a(989),D=a(988),A=a(37),B=a(31),L=a.n(B),_=a(295),F=a.n(_),$=a(231),U=a.n($),z=a(6),V=a.n(z),W=a(247),G=a(113),q=a(118),H=a(297),J=a(211),Y=a(2),Z=a(1261),K=Object(Y.a)(Z.b,(function(e,t){return{uuid:e,matchId:t}})),Q=Object(Y.a)(Z.a,(function(e){return{matchId:e}})),X=a(1212),ee=a(1148),te=a(148),ae=a(204),se=[{key:"isSuperLikedByMe",text:"youMatchedOnDateViaSuperLikeByYou"},{key:"isSuperLike",text:"youMatchedOnDateViaSuperLike"},{key:"isSuperBoostMatch",text:"youMatchedOnDateViaSuperBoostMatch"},{key:"isBoostMatch",text:"youMatchedOnDateViaBoostMatch"},{key:"isFastMatch",text:"youMatchedOnDateViaFastMatch"}],ne=function(e){var t=e.className,a=e.color,s=e.date,n=e.matchName,r=e.size,i=e.gender,o=se.find((function(t){return!!e[t.key]}))||{text:"youMatchedOnDate"};return c()("div",{className:Object(A.a)(r,a,t)},void 0,c()(te.a,{value:s},void 0,(function(e){return c()(ae.a,{id:o.text,values:{matchName:n,formattedDate:e,gender:i}})})))};ne.defaultProps={className:void 0,color:"C($c-secondary)",gender:0,isBoostMatch:!1,isSuperLike:!1,isFastMatch:!1,isSuperLikedByMe:!1,isSuperBoostMatch:!1,size:"Fz($2xs)"};var re=Object(k.memo)(ne),ie=Object(k.memo)((function(e){var t=e.date;return c()("div",{className:"Ta(c) Fz($2xs) C($c-secondary) Py(4px)"},void 0,c()(te.a,{value:t})," ",c()(te.d,{value:t}))})),oe=a(281),ce=a(328),de=a(46),le=a.n(de),pe=a(4),ue=a(117),he=a(8),ge=a(1153),me=a(1133),fe=a(449),ve=a(40),be=a(318),ye=a(267),Ie=a(218);function Oe(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function Me(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Oe(Object(a),!0).forEach((function(t){M()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Oe(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var ke=(function(e){function t(){var e,a;l()(this,t);for(var s=arguments.length,n=new Array(s),r=0;r<s;r++)n[r]=arguments[r];return a=g()(this,(e=f()(t)).call.apply(e,[this].concat(n))),M()(b()(a),"state",{canPlay:!1,source:a.props.src}),M()(b()(a),"loadTimeStart",0),M()(b()(a),"setVideo",(function(e){a.video=e})),M()(b()(a),"handleCanPlay",(function(){a.state.canPlay||a.setState({canPlay:!0},a.props.onLoaded(null,Date.now()-a.loadTimeStart))})),a}return I()(t,e),u()(t,[{key:"componentDidMount",value:function(){this.loadTimeStart=Date.now(),this.showPoster=Object(ye.a)()}},{key:"componentDidUpdate",value:function(e,t){this.state.canPlay&&t.source!==this.state.source&&this.video&&this.video.load()}},{key:"render",value:function(){var e=this.props,t=(e["data-testid"],e.className),a=e.enterCount,s=e.forwardedRef,n=e.height,r=e.inViewport,i=e.loadingIconFillColor,o=e.poster,d=e.style,l=e.width,p=this.state,u=p.canPlay,h=p.source,g=a>0||r;return S.a.createElement("div",{className:"Pos(r)",ref:s},c()(ce.AspectRatio,{className:Object(A.a)({"Op(0)":!u},"Trsdu($fast)",t),ratio:"".concat(l,"/").concat(n),style:Me({},d,{width:"".concat(l,"px")})},void 0,g&&S.a.createElement("video",{ref:this.setVideo,className:t,autoPlay:!0,loop:!0,muted:!0,onCanPlay:this.handleCanPlay,playsInline:!0,poster:this.showPoster?o:void 0},c()("source",{src:h,type:"video/mp4"}))),c()("div",{className:Object(A.a)({"D(n)":u},"Pos(a) T(0)")},void 0,c()(ce.AspectRatio,{className:t,ratio:"".concat(l,"/").concat(n),style:Me({},d,{width:"".concat(l,"px")})},void 0,c()("div",{className:"CenterAlign"},void 0,c()(Ie.a,{className:"D(b) Sq(40px) Mx(a) Trfo(c) Animn($anim-logo) Animdur($xslow) Animic(i) Animtf($anim-logo-timing-func)",fill:i})))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return t.canPlay?!e.inViewport&&t.source?{source:""}:e.inViewport&&!t.source?{source:e.src}:null:null}}]),t})(k.PureComponent);M()(ke,"defaultProps",{loadingIconFillColor:ve.O,onLoaded:le.a,style:{}});var Se=Object(be.handleViewport)(ke,{},{disconnectOnLeave:!1}),xe=(a(1012),"Sq(8px) My(6px) Mx(3px) Bdrs(50%) Bg($c-secondary) Op(.2) Animdur(.75s) Animn($anim-pulse) Animic(i) Animtf(l)"),Pe=c()("div",{className:xe}),Ce=function(e){var t=e.className;return c()("div",{className:Object(A.a)(t,"CenterAlign Pt(1px)")},void 0,Pe,c()("div",{className:Object(A.a)(xe,"Animdel($normal)")}),c()("div",{className:Object(A.a)(xe,"Animdel($slow)")}))};Ce.defaultProps={className:""};var Re=Object(k.memo)(Ce),je=a(1406),we=new(a.n(je).a);we.add("ftp:",null).set({fuzzyIP:!0});var Ee=function(e,t){return t?t.trim().length?e.push({type:"text",text:t}):e.push({type:"text",text:t,spaceOnly:!0}):e},Ne=function(e){var t=[];return e.forEach((function(e){if("text"===e.type){var a=(function(e){var t=[];if(!we.pretest(e))return Ee(t,e),t;var a=we.match(e);if(!a)return Ee(t,e),t;var s=0;return a.forEach((function(a){var n=a.text,r=a.index,i=a.lastIndex;r>s&&Ee(t,e.substring(s,r)),(function(e,t,a){t&&e.push({type:"link",text:t,href:a})})(t,n,a.url),s=i})),e.length>s&&Ee(t,e.substring(s)),t})(e.text);t=t.concat(a)}else t.push(e)})),t},Te=a(1412),De=a(244),Ae=a(51),Be=a(25),Le=a(1110),_e=a(53),Fe=a(1199),$e=a(1144),Ue=function(e){var t=e.className,a=e.content,s=e.left;return c()("svg",{className:t,width:"41",height:"52",viewBox:"0 0 41 52"},void 0,c()("g",{fill:"none",fillRule:"evenodd"},void 0,c()("path",{fill:"#fff",stroke:"#e5e5e5",strokeWidth:".5",d:s?"M35.94 33.256a6.7 6.7 0 0 1 1.295 3.973c0 3.701-2.98 6.702-6.66 6.702a6.652 6.652 0 0 1-5.846-3.492 19.91 19.91 0 0 1-4.507.514c-11.03 0-19.972-9-19.972-20.101C.25 9.75 9.191.75 20.222.75c11.03 0 19.972 9 19.972 20.102 0 4.562-1.515 8.892-4.255 12.404zm-7.83 18.616a3.218 3.218 0 0 1-3.208-3.228 3.218 3.218 0 0 1 3.209-3.228 3.218 3.218 0 0 1 3.208 3.228 3.218 3.218 0 0 1-3.208 3.228z":"M5.005 32.756a6.7 6.7 0 0 0-1.297 3.973c0 3.701 2.982 6.702 6.66 6.702a6.65 6.65 0 0 0 5.847-3.492 19.91 19.91 0 0 0 4.507.514c11.03 0 19.972-9 19.972-20.101C40.694 9.25 31.752.25 20.722.25 9.692.25.75 9.25.75 20.352c0 4.562 1.515 8.892 4.255 12.404zm7.828 18.616a3.218 3.218 0 0 0 3.208-3.228 3.218 3.218 0 0 0-3.208-3.228 3.218 3.218 0 0 0-3.208 3.228 3.218 3.218 0 0 0 3.208 3.228z"}),c()("text",{fill:"#4a4a4a",fontSize:"24",transform:"translate(1 .5)"},void 0,c()("tspan",{x:"7.222",y:"30"},void 0,a))))};Ue.defaultProps={content:"ðŸ”¥",left:!0};var ze,Ve=Object(k.memo)(Ue),We=a(1162),Ge={anthem:"profileChangeAnthem",changeBio:"profileChangeBio",changeSchool:"profileChangeSchool",changeWork:"profileChangeWork",loop:"profileAddLoop",match:"match",photo:"profileAddPhoto",topArtist:"profileSpotifyTopArtist",unsupported:"unsupported"},qe=(ze={},M()(ze,Ge.changeBio,{titleIntlId:"bio",color:"C($c-blue)"}),M()(ze,Ge.changeSchool,{titleIntlId:"school",color:"C($c-orange)"}),M()(ze,Ge.changeWork,{titleIntlId:"work",color:"C($c-green)"}),ze),He=new Set([Ge.anthem,Ge.topArtist]),Je=c()("div",{className:"Expand CenterAlign Fld(c)"},void 0,c()("img",{loading:"lazy",className:"Sq(100px) Mb(24px)",src:We.a}),c()("div",{className:"C($c-secondary) Fz($xs) Fw($semibold)"},void 0,c()(ae.a,{id:"photoUnavailable"}))),Ye=(function(e){function t(e){var a;return l()(this,t),a=g()(this,f()(t).call(this,e)),M()(b()(a),"handlePhotoError",(function(){a.setState({photoError:!0})})),a.state={photoError:!1},a.activityEvent=e.activityFeedItem.get("activityEvent"),a.type=Ge.unsupported,Object.entries(Ge).forEach((function(e){var t=i()(e,2)[1];a.activityEvent.get(t)&&(a.type=t)})),a}return I()(t,e),u()(t,[{key:"getPhotoUrls",value:function(e){var t,a=this.props,s=a.activityFeedItem,n=a.isReceived,r=a.matchPhotos,i=a.ownPhotos,o=n?i:r;switch(e){case Ge.photo:t=this.activityEvent.getIn(["profileAddPhoto","photos",0]);break;case Ge.loop:t=this.activityEvent.getIn(["profileAddLoop","loops",0]);break;case Ge.match:case Ge.changeBio:case Ge.changeSchool:case Ge.changeWork:default:var c=s.getIn(["comments",0,"metadata","carouselItemId"]);t=o.find((function(e){return e.get("id")===c}))||o.first()}return Object(Ae.r)(t,[2,0])}},{key:"getVideoUrls",value:function(){return Object(Ae.u)(this.activityEvent.getIn(["profileAddLoop","loops",0]))}},{key:"getProfileChangeInfo",value:function(e){switch(e){case Ge.changeBio:var t=this.activityEvent.getIn(["profileChangeBio","bio"],""),a=this.activityEvent.getIn(["profileChangeBio","oldBio"],""),s=Object(Te.diffLines)(a,t).filter((function(e){return e.added}));return V()(s,[0,"value"],t);case Ge.changeSchool:var n=this.activityEvent.getIn(["profileChangeSchool","schools"],_e.a);return(Object(Le.f)(n)||[]).join(",");case Ge.changeWork:var r=this.activityEvent.getIn(["profileChangeWork","works",0],_e.b);return Object(Le.e)(r.get("title"),r.get("company"));default:return""}}},{key:"renderSpotify",value:function(e){var t,a;switch(e){case Ge.anthem:t=this.activityEvent.getIn(["profileChangeAnthem","anthem"]),a=this.activityEvent.getIn(["profileChangeAnthem","anthem","artists",0]);break;case Ge.topArtist:var s=this.props.activityFeedItem.getIn(["comments",0,"metadata","carouselItemId"]);t=(a=this.activityEvent.getIn(["profileSpotifyTopArtist","artists"]).find((function(e){return e.getIn(["tracks",0,"id"])===s}))).getIn(["tracks",0]);break;default:return null}return t?c()($e.b,{className:"W(100%) D(f) Pos(a) B(32px) Pstart(12px) Pend(12px)",template:$e.a.feed,track:t,artistName:a&&a.get("name")}):null}},{key:"render",value:function(){var e=this.props.isReceived;if(this.type===Ge.unsupported)return null;var t=!!this.props.activityFeedItem.get("reactions"),a=this.props.activityFeedItem.getIn(["comments",0,"message"]);return c()("div",{className:Object(A.a)({"Mt(40px)":t,"NetMaxWidth(500px,62px)--ml":e,"Mstart(a)--ml Maw(500px)--ml":!e})},void 0,c()("div",{className:Object(A.a)("Pos(r) H(0)",{"NetWidth(100%,-62px)--ml NetPaddingTop(100%,-62px)--ml":e,"Mend(-100px)--s W(100%)--s Pt(100%)--s":e,"W(100%) Pt(100%)":!e})},void 0,c()("div",{className:"Expand Pos(a) T(0) Start(0) Bg($c-light-grey) Bdrs(8px) Ov(h)"},void 0,this.state.photoError?Je:c()(fe.b,{className:Object(A.a)("Expand",{"Bg($orange-gradient)::b Cnt($blank)::b Op(.4)::b StretchedBox::b":qe[this.type]}),intendedAspectRatio:1,onError:this.handlePhotoError,urls:this.getPhotoUrls(this.type)}),qe[this.type]&&c()("div",{className:"StretchedBox CenterAlign Fld(c) C(#fff) Fz($l) Fz($s)--s Fw($semibold) Ta(c) P(20px) P(10px)--s"},void 0,c()("div",{className:Object(A.a)("Tt(u) Fs(i) Fw($bold) My(4px)",qe[this.type].color)},void 0,c()(ae.a,{id:qe[this.type].titleIntlId})),c()("div",{className:"LineClamp(5,170.625px) LineClamp(5,105px)--s"},void 0,this.getProfileChangeInfo(this.type))),this.type===Ge.loop&&c()(Fe.a,{className:"W(100%)",urls:this.getVideoUrls()}),He.has(this.type)&&this.renderSpotify(this.type)),t&&c()("div",{className:Object(A.a)("Pos(a) T(0)",{"Start(0) Translate(-50%,-50%)":!e,"End(0) Translate(50%,-50%)":e})},void 0,c()(Ve,{className:"Scale(1.2)--ml",content:a,left:e}))))}}]),t})(k.PureComponent);M()(Ye,"defaultProps",{isReceived:!1,matchPhotos:_e.a,ownPhotos:_e.a});var Ze=Object(E.c)((function(e,t){return{matchPhotos:Object(De.g)(e)(t.activityFeedItem.get("matchId")).getIn(["person","photos"]),ownPhotos:Object(Be.hb)(e)}}))(Ye),Ke=a(1124),Qe=a(263),Xe=a(1306),et=function(e){var t,a,s=e.contextualContextMetaData,n=e.gender,r=e.isContextualLike,i=e.isContextualMessage,o=e.isMe,d=e.isReaction,l=e.isSwipeNote,p=e.matchName,u=e.message,h=Object(k.useRef)("");s&&(t=s.getIn(["photo","url"],null),a=s.get("reaction_id"));var g=Object(k.useMemo)((function(){return d&&a?a:l?Qe.d:null}),[l,d,a]),m=Object(k.useMemo)((function(){return l||i?(h.current=l?"swipenote":"contextual-message",u):d||r?(d&&(h.current="reaction",e=o?"Reactions.youReactedToPhoto":"Reactions.recMessageContent"),r&&(h.current="contextual-like",e=o?"Reactions.youLikedPhoto":"Reactions.matchLikedYourPhoto"),c()(ae.a,{id:e,values:{matchName:p,gender:n},tagName:"span"})):null;var e}),[r,i,d,l,n,p,o,u]);return c()("div",{className:"Pos(r) D(f) Fxd(c)"},void 0,c()("div",{},void 0,c()(Xe.a,{name:p,urls:t?[t]:[],className:"Bdbw(0) TranslateY(20px)",imageStyle:"medium",darkBackground:!0}),g&&c()("div",{className:Object(A.a)("Pos(a) T(0)",{"Start(108px)":!o,"End(112px)":o})},void 0,c()(Ke.a,{reactionId:g,className:"Sq(44px) M(a)"}))),!!m&&c()("div",{className:"W(100%)"},void 0,c()("div",{className:Object(A.a)("Bd Bdc($c-transparent-white) Pos(r) Whs(pw)","Px(12px) Py(10px) BreakWord","W(fc) D(ib) Us(t) Z(1)",{"Bdrsbstart(4px) Bdrststart(18px) Bdrstend(18px) Bdrsbend(18px) Bgc($c-medium-grey)":!o,"C(#fff) Bdrsbstart(18px) Bdrststart(18px) Bdrstend(18px) Bdrsbend(4px) Bgc($c-superlike-blue)":o})},void 0,m)))};et.defaultProps={className:"",contextualContextMetaData:null};var tt=et,at=a.p+"39284996c10459d2ed3762f8bc1e8443.svg",st=a.p+"d7114c955c041abd8543f3436b0e3974.svg",nt=a.p+"14af12bedf22c63c4e045a5d4ac57d23.svg",rt=a.p+"287913f29d0fc49de4a93d4a6b093834.svg",it=a.p+"633edfa442d7a2ef3bdbaf9577bf81a4.svg",ot=a.p+"95de881d0158bcb934681746031ef293.svg",ct=a.p+"d09d7a3147a7754e3e51e18d0ee63439.svg",dt=a.p+"bcab0a7e46e185f0032aedd0cd6f8c4d.svg",lt={snapchat:{asset:ct,cta:function(e){var t=e.contactId;return"https://snapchat.com/add/".concat(t)}},instagram:{asset:st,cta:function(e){var t=e.contactId;return"https://instagram.com/".concat(t)}},facebook:{asset:at,cta:function(e){var t=e.contactId;return"https://facebook.com/".concat(t)}},kakaotalk:{asset:nt},line:{asset:it,cta:function(e){var t=e.contactId;return"https://line.me/R/ti/p/".concat(t)}},kik:{asset:rt,cta:function(e){var t=e.contactId;return"https://kik.me/".concat(t)}},wechat:{asset:a.p+"496da89b4b836c48473278291640d10d.svg"},vk:{asset:dt,cta:function(e){var t=e.contactId;return"https://vk.com/".concat(t)}},whatsapp:{asset:a.p+"cc82db8b0f33bbf9c8c09c86a7de457f.svg",cta:function(e){var t=e.contactId;return"https://wa.me/".concat(t)}},phone:{asset:ot,cta:function(e){var t=e.contactId;return"tel:".concat(t)}}},pt=Object(k.memo)((function(e){var t=e.contactId,a=e.contactType,s=e.message,r=void 0===s?"":s,i=e.onClick,o=V()(lt,[a,"asset"]),d=V()(lt,[a,"cta"]);if(!o)return null;var l=d?ue.a:"div",p={"data-testid":"msg-contact-card",href:void 0,target:void 0,i13nModel:void 0};return d&&(p.href=d({contactId:t}),p.target="_blank",p.i13nModel={label:"ContactCard",message:"click ".concat(a)}),c()("div",{className:"D(ib) Px(12px) Py(10px) Bgc(#fff) Bd Bdc($c-divider) Bdrs(8px)",title:r,onClick:i},void 0,S.a.createElement(l,n()({className:"D(f) Ta(start)"},p),c()("img",{className:"Mend(12px) Sq(40px)",src:o,alt:a}),c()("div",{},void 0,c()("div",{className:"Fw($semibold)"},void 0,c()(ae.a,{id:a})),c()("div",{className:"Us(t)"},void 0,t))))})),ut=a(12),ht=a(1204),gt=a(1324),mt=c()("div",{className:"Expand CenterAlign Fld(c)"},void 0,c()("img",{loading:"lazy",className:"Sq(100px) Mb(24px)",src:We.a}),c()("div",{className:"C($c-secondary) Fz($xs) Fw($semibold)"},void 0,c()(ae.a,{id:"photoUnavailable"}))),ft=c()(gt.a,{}),vt=(function(e){function t(){var e,a;l()(this,t);for(var s=arguments.length,n=new Array(s),r=0;r<s;r++)n[r]=arguments[r];return a=g()(this,(e=f()(t)).call.apply(e,[this].concat(n))),M()(b()(a),"state",{photoError:!1}),M()(b()(a),"handleClickRec",(function(){a.props.user&&a.props.onClickSharedProfile(a.props.user)})),a}return I()(t,e),u()(t,[{key:"componentDidMount",value:function(){var e=this.props.sharedProfile.get("id");e&&this.props.getOtherUserById(e)}},{key:"getPhoto",value:function(){var e=this.props.user,t=e.get("photos",new ut.List).get(e.get("activePhotoIndex",0));return{urls:Object(Ae.r)(t,[2,0])}}},{key:"handlePhotoError",value:function(){this.setState({photoError:!0})}},{key:"render",value:function(){var e=this.props,t=e.user,a=e.isReceived;if(!t)return null;var s=this.getPhoto();return c()("div",{className:Object(A.a)("Maw(300px)--ml",{"Mstart(a)--ml":!a}),onClick:this.handleClickRec},void 0,c()("div",{className:"Pos(r) Bdrs(16px) Ov(h) H(0) Pt(137%)"},void 0,c()("div",{className:"Expand Pos(a) T(0) Start(0) Bg($c-light-grey) Cur(p)"},void 0,this.state.photoError?mt:c()(k.Fragment,{},void 0,c()(fe.a,{alt:t.get("name"),className:"Bdrs(8px) Bgz(cv) Bgp(c) Expand",loader:fe.d.NORMAL,deferLoadUntilInViewport:!0,onError:this.handlePhotoError,urls:s.urls,intendedAspectRatio:"natural"}),c()("div",{className:"Pos(a) D(f) Ai(c) Jc(sb) Fz($m)--ml Fz($s)--s B(0) W(100%) P(20px) C(#fff)"},void 0,c()("span",{className:"Ta(start) Ell W(75%)"},void 0," ",t.get("name")," "),ft)))))}}]),t})(k.PureComponent);var bt={getOtherUserById:ht.a},yt=Object(E.c)((function(e,t){return{user:Object(H.f)(e,t.sharedProfile.get("id"))}}),bt)(vt),It=a(87);function Ot(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function Mt(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Ot(Object(a),!0).forEach((function(t){M()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Ot(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var kt=(function(e){function t(){var e,a;l()(this,t);for(var s=arguments.length,n=new Array(s),r=0;r<s;r++)n[r]=arguments[r];return a=g()(this,(e=f()(t)).call.apply(e,[this].concat(n))),M()(b()(a),"getCommonEventProperties",(function(){var e=a.props,t=e.matchId,s=e.messageObject,n=e.otherId,r=e.vinylItem;return{contentId:r.get("id"),contentURL:r.get("uri")||"".concat(he.a.spotifyTrackUrl).concat(r.get("id")),contentSource:"spotify",fromUserId:s.get("from"),fromSelf:s.get("from")!==n,matchId:t,messageId:s.get("_id")}})),M()(b()(a),"handlePlaySong",(function(){a.props.trackEvent(It.k,Mt({},a.getCommonEventProperties(),{type:"play song"})),a.timeStartedPlaying=Date.now()})),M()(b()(a),"handlePauseSong",(function(){var e;a.timeStartedPlaying&&(e=Date.now()-a.timeStartedPlaying),a.props.trackEvent(It.k,Mt({},a.getCommonEventProperties(),{type:"stop song",durationInMillis:e})),a.timeStartedPlaying=0})),M()(b()(a),"handlePlayFullSong",(function(){var e;a.timeStartedPlaying&&(e=Date.now()-a.timeStartedPlaying),a.props.trackEvent(It.k,Mt({},a.getCommonEventProperties(),{type:"play on spotify",durationInMillis:e})),a.timeStartedPlaying=0})),a}return I()(t,e),u()(t,[{key:"render",value:function(){var e=this.props,t=e.isLeft,a=e.vinylItem;return c()("div",{className:Object(A.a)("D(f)",{"Jc(fe)":!t})},void 0,c()($e.b,{className:Object(A.a)("W(300px)--ml W(228px)--s D(f) Mt(8px) Bd Bdc($c-beacon-gray) Bdrs(4px) P(12px)",{"Jc(fe)":!t}),template:$e.a.vinylMessage,track:a,artistName:a.getIn(["artists",0,"name"]),onPlaySong:this.handlePlaySong,onPauseSong:this.handlePauseSong,onPlayFullSong:this.handlePlayFullSong}))}}]),t})(k.PureComponent),St=function(e){return 2*Math.round(e/2)};function xt(e){if(!e)return 0;var t=getComputedStyle(e),a=parseFloat(t.paddingLeft)+parseFloat(t.paddingRight),s=parseFloat(t.marginLeft)+parseFloat(t.marginRight);return St(e.offsetWidth-a-s)}var Pt=function(e,t){return e.size>0?e.reduce((function(e,a){return e+(a.get("from")===t?0:1)}),0):0},Ct=function(e){return e.size>0?e.last().get("from"):null},Rt=function(e,t){return e.replace(/.gif|.webp|.png/,t)},jt=a(230),wt=a(1305),Et=a(1187),Nt=a(1150),Tt=a(144),Dt=a(1338),At=a(452),Bt=a(55),Lt=a(137),_t=a(94),Ft=a(85),$t=c()(ae.a,{id:"Incentives.somethingWentWrong"}),Ut=c()(ae.a,{id:"delete"}),zt=c()(Et.a,{fill:"#fff",title:c()(ae.a,{id:"ReadReceipts.read"}),className:"Sq(12px)"}),Vt=c()("span",{className:"Mstart(8px) Animn($anim-slide-in-right) Animdur($fast)"},void 0,c()(ae.a,{id:"ReadReceipts.turnOn"})),Wt=c()(Nt.a,{className:"Sq(8px) C($c-blue)",stroke:2,color:ve.c}),Gt=c()(Dt.a,{className:"Sq(20px) C($c-pink)",pathClassName:""}),qt=c()(ae.a,{id:"no"}),Ht=c()(At.a,{width:24,height:24}),Jt=c()(ae.a,{id:"yes"}),Yt=(function(e){function t(){var e,a;l()(this,t);for(var s=arguments.length,n=new Array(s),r=0;r<s;r++)n[r]=arguments[r];return a=g()(this,(e=f()(t)).call.apply(e,[this].concat(n))),M()(b()(a),"state",{showReadReceiptOptions:!1,closeAnimation:!1}),M()(b()(a),"handleCLickReadReceipt",(function(){a.props.readReceiptsRemaining?a.setState({showReadReceiptOptions:!0,closeAnimation:!1}):a.props.openModal(Bt.N,{props:{from:Ft.D}})})),M()(b()(a),"handleDeleteMsg",(function(){a.props.onDeleteMessage()})),M()(b()(a),"handleCloseReadReceiptOptions",(function(){a.setState({closeAnimation:!0}),a.collapseTimeout=setTimeout((function(){a.setState({showReadReceiptOptions:!1,closeAnimation:!1})}),1e3)})),M()(b()(a),"handleClickUseReadReceipt",(function(){a.props.consumeReadReceipt(a.props.matchId)})),a}return I()(t,e),u()(t,[{key:"componentDidUpdate",value:function(e){var t=this;!e.readReceiptError&&this.props.readReceiptError&&(this.errorTimeout=setTimeout((function(){t.props.clearReadReceiptError()}),3e3)),e.isReadReceiptLoading&&!this.props.isReadReceiptLoading&&this.handleCloseReadReceiptOptions()}},{key:"componentWillUnmount",value:function(){this.errorTimeout&&(clearTimeout(this.errorTimeout),this.errorTimeout=null),this.collapseTimeout&&(clearTimeout(this.collapseTimeout),this.collapseTimeout=null)}},{key:"getDesktopMessageState",value:function(){var e=this.props.messageState;return e===ge.a?"ChatMessage.failureDesktop":"ChatMessage.".concat(e)}},{key:"getReadReceiptError",value:function(){var e=this.props,t=e.readReceiptError,a=e.matchName;switch(t){case _t.n:return c()(ae.a,{id:"ReadReceipts.turnedOff",values:{matchName:a}});case _t.g:default:return $t}}},{key:"render",value:function(){var e=this.props,t=e.messageState,a=e.hasReadReceiptProducts,s=e.isReadReceiptLoading,n=e.readReceiptsRemaining,r=e.readReceiptError,i=this.state.showReadReceiptOptions,o=t===ge.a,d=t===ge.b&&(a||n)&&!r;return c()(k.Fragment,{},void 0,c()("div",{className:Object(A.a)("msg__status Pos(r) Fz($2xs) My(8px) Mx(4px)",{"Mt(12px) C($c-pink) Cur(p)":o,"C($c-secondary)":!o,"D(f) Ai(c) Jc(fe) Fld(r)":d&&!o||r})},void 0,o?c()(ue.b,{className:Object(A.a)(Lt.c,"msg__deleteBtn C($c-secondary) C(#000):h Td(u):h Cur(p)"),onClick:this.handleDeleteMsg,i13nModel:{label:"Message",message:"Delete message"}},void 0,Ut):null,d?c()("div",{className:Object(A.a)("D(f) Jc(c) Fld(r) Mend(8px)",{"Ai(c)":i,"Ai(fs)":!i}),onClick:this.handleCLickReadReceipt},void 0,c()("button",{className:Object(A.a)(Lt.c,"Sq(16px) Bgc($c-blue) Bdrs(50%) CenterAlign Cur(p) P(0)")},void 0,zt),i?Vt:Wt):null,r?c()("span",{className:"Mend(16px) Animn($anim-slide-in-right) Animdur($xslow)"},void 0,Gt,c()("span",{className:"Mstart(4px)"},void 0,this.getReadReceiptError())):null,c()(Tt.c,{},void 0,c()("span",{className:Object(A.a)({"Td(u):h":o})},void 0,c()(ae.a,{id:"ChatMessage.".concat(t)}))),c()(Tt.a,{},void 0,c()("span",{className:Object(A.a)({"Td(u):h":o})},void 0,c()(ae.a,{id:this.getDesktopMessageState()})))),i&&c()("div",{className:Object(A.a)("Pos(r) Fz($xs) My(8px) C($c-secondary) Ai(fs) Jc(fe) Fld(r) Mend(48px) D(if)",{"Animn($anim-grow-to-full) Animdur($slow)":!this.state.closeAnimation,"Animn($anim-shrink) Animdur($xslow)":this.state.closeAnimation})},void 0,c()("button",{className:Object(A.a)(Lt.c,"Pend(16px) Fw($bold) MStart(0) Cur(p) Bdendc($c-dark-gray) Bdendw(2px) Bdends(s)"),onClick:this.handleCloseReadReceiptOptions},void 0,qt),c()("div",{className:"CenterAlign Fld(c) Mstart(8px) Cur(p)"},void 0,s?Ht:c()("button",{className:Object(A.a)(Lt.c,"C($c-superlike-blue) Fw($bold) Cur(p)"),onClick:this.handleClickUseReadReceipt},void 0,Jt),c()("span",{className:"Fz($2xs)"},void 0,"(",c()(ae.a,{id:"ReadReceipts.remaining",values:{remainingNumber:n}}),")"))))}}]),t})(k.PureComponent);function Zt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function Kt(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Zt(Object(a),!0).forEach((function(t){M()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Zt(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var Qt=c()(Re,{}),Xt=(function(e){function t(){var e,a;l()(this,t);for(var s=arguments.length,n=new Array(s),r=0;r<s;r++)n[r]=arguments[r];return a=g()(this,(e=f()(t)).call.apply(e,[this].concat(n))),M()(b()(a),"state",{supportWebp:Object(he.e)("webp")}),M()(b()(a),"handleClickLink",(function(e,t){var s=a.props,n=s.matchId,r=s.message,i=s.otherId,o=s.sentDate;a.props.trackEvent(pe.P,{matchId:n,message:r,otherId:i,url:e,timeSinceSent:Date.now()-new Date(o),type:t}),a.props.trackChatInteract(jt.k,jt.i,Kt({contentURL:e},a.analyticsData))})),M()(b()(a),"handleClick",(function(e){var t=e.currentTarget;a.props.trackChatInteract(jt.k,jt.h,Kt({},a.analyticsData)),t.focus()})),M()(b()(a),"handleDeleteMsg",(function(){a.props.trackChatInteract(jt.k,jt.f,Kt({button:"delete",source:"chat"},a.analyticsData)),a.props.deleteMsg(a.props.messageObject)})),a}return I()(t,e),u()(t,[{key:"renderSendStatus",value:function(){var e=this.props,t=e.clearReadReceiptError,a=e.consumeReadReceipt,s=e.isReadReceiptLoading,n=e.matchId,r=e.messageState,i=e.matchName,o=e.messageObject,d=e.hasReadReceiptProducts,l=e.readReceiptsRemaining,p=e.readReceiptError,u=e.openModal,h=e.trackChatInteract,g=e.isSwipeNoteMessage,m=e.isContextualMessage;return g||m?null:c()(Yt,{consumeReadReceipt:a,clearReadReceiptError:t,isReadReceiptLoading:s,matchId:n,matchName:i,messageObject:o,messageState:r,openModal:u,onDeleteMessage:this.handleDeleteMsg,hasReadReceiptProducts:d,readReceiptsRemaining:l,readReceiptError:p,trackChatInteract:h})}},{key:"renderTextMessage",value:function(e,t){var a=this,s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=this.props.isLeft;return e.map((function(e,r){var i=e.type;"link"===i&&(a.containsUrl=!0);var o=s?null:Object(A.a)(i,{"D(ib)":!t&&!e.spaceOnly,"Mx(2px) Va(m)":"emoji"===i,"Va(t)":"text"===i,"Fz(50px) C($c-base) Fl(start) Mb(-10px)--ml":t});return c()("span",{className:o},r,"link"===i?c()(ue.a,{className:Object(A.a)("Td(u)",{"C(#fff)":!n,"C($c-blue)":n}),href:e.href,i13nModel:{label:"Message",message:"Inline Link"},target:"_blank",onClick:function(){return a.handleClickLink(e.href,"inline")}},void 0,e.text):e.text)}))}},{key:"render",value:function(){var e,t,a,s,n=this.props,r=n.activityFeedItem,i=n.intl,o=n.isActivityFeed,d=n.isProfile,l=n.isFirstInGroup,p=n.isImage,u=n.isGif,h=n.isLeft,g=n.isTypingIndicator,m=n.isSwipeNoteMessage,f=n.isContextualMessage,v=n.contextualContextMetaData,b=n.isVinylMessage,y=n.maxWidth,I=n.message,O=n.onClickSharedProfile,M=n.sentDate,S=n.sharedProfile,x=n.gender,P=n.matchId,C=n.matchName,R=n.messageObject,j=n.messageState,w=n.media,E=n.trackEvent,N=n.otherId,T=n.vinylItem,D=n.isMessageRead,B=n.lastReadMessageTimeStamp,L=n.shouldShowReadReceipt,_=v&&(m||f),F=R&&!!R.get("contact_card"),$=d?R&&R.getIn(["profile","message"]):I,U=r&&r.get("reactions"),z=M&&c()(te.d,{value:M},void 0,(function(e){return c()("div",{className:Object(A.a)("Pos(a) Px(10px) Fz($2xs) Whs(nw) Us(t) T(50%) Trsdu($fast) Trsp($opacity)","C($c-secondary) Op(0) msgHelper:h_Op(1) msgHelper:f_Op(1)",{"End(0) Translate(100%,-50%)":h,"Start(0) Translate(-100%,-50%)":!h})},void 0,e)})),V=(s=$,Ne(Object(me.c)(s))),W=b&&T,G=_&&V?c()("div",{},void 0,this.renderTextMessage(V,!1,!0)):null;if(u){var q=Object(oe.parse)(Object(oe.extract)($));e=q.width,t=q.height,e=St(e),t=St(t)}var H=!g&&!o&&!d&&V&&Object(me.a)(V,!1),J=Object(A.a)("msg BreakWord D(ib) Ta(start) Us(t) Pos(r) Whs(pw) Va(m) Maw(100%)",{"C(#000) msg--received Op(1) Trsp($opacity) Trsdu($fast) Trsde($normal)":h,"C(#fff)":!h,"P(0)":u,"Px(12px) Py(10px)":!H&&!u&&!U,"D(n)!":U}),Y=Object(A.a)({"msgBackground--received":h,"Bdrstend(16px) Bdrsbend(16px) msgBackground--received":h,"Bdrsbstart(4px) Bdrststart(4px)":h&&!l,"Bdrsbstart(4px) Bdrststart(16px)":h&&l,"Bgc($c-medium-grey)":h&&!H&&!p&&!U,"Bdrsbstart(16px) Bdrststart(16px)":!h,"Bdrstend(4px) Bdrsbend(4px)":!h&&!l,"Bdrstend(16px) Bdrsbend(4px)":!h&&l,"Bgc($c-superlike-blue)":!(h||H||p||U),"Ov(h)":u,"Bd Bdc(#fff)":o||d});if(w){var Z=w.get("width")||1,K=w.get("height")||1,Q=w.get("url");"bitmoji"===w.get("source")&&(Q=this.state.supportWebp?Rt(Q,".webp"):Q),a=c()(ce.AspectRatio,{ratio:"".concat(K,"/").concat(Z)},void 0,c()(fe.a,{urls:[Q],deferLoadUntilInViewport:!0}))}return c()(k.Fragment,{},void 0,d&&c()(yt,{sharedProfile:S,isReceived:h,onClickSharedProfile:O}),o&&c()(Ze,{activityFeedItem:r,isReceived:h}),W&&c()(kt,{isLeft:h,matchId:P,messageObject:R,otherId:N,trackEvent:E,vinylItem:T}),F&&c()(pt,{onClick:this.handleClick,contactType:R.getIn(["contact_card","contact_type"]),contactId:R.getIn(["contact_card","contact_id"]),message:R.get("message")}),_?c()(tt,{isSwipeNote:m,isContextualMessage:f,contextualContextMetaData:v,message:G,isMe:!h,gender:x,matchName:C}):null,W||_||F||U||!V||d&&!(d&&V.length>0)?null:c()("div",{className:Object(A.a)("msgHelper D(ib) Pos(r) Maw(100%) Va(m)",{"B(12px)--ml Mb(-12px)--ml B(16px)--s Mb(-16px)--s":o||d,"W(100%) Maw(300px)--ml":p}),onClick:this.handleClick,tabIndex:"0"},void 0,p&&a,!o&&!d&&z,!u&&c()("div",{className:Object(A.a)("Pos(a) Expand B(0) Mah(100%) Maw(100%)",Y)}),c()("div",{className:J},void 0,!u&&!F&&!p&&this.renderTextMessage(V,H),g&&Qt,u&&c()(Se,{className:Y,src:Rt($,".mp4"),poster:this.state.supportWebp?Rt($,".webp"):$,alt:i.formatMessage({id:"giphy"}),height:t,width:e,style:{maxWidth:y&&"".concat(y,"px")||"100%"},loadingIconFillColor:h?ve.O:ve.I}))),j===ge.b&&L?c()(wt.a,{isRead:D,messageTimeStamp:B}):j&&this.renderSendStatus())}},{key:"isTextMessage",get:function(){var e=this.props,t=e.media,a=e.isGif,s=e.isVinylMessage,n=e.isImage;return!(t||a||s||n)}},{key:"analyticsData",get:function(){var e=this.props,t=e.message,a=e.media,s=e.isGif,n=e.isVinylMessage,r={messageId:e.messageId,containsUrl:this.containsUrl};if(this.isTextMessage)return r;if(a)return Kt({contentSource:a.get("source"),contentURL:a.get("url")},r);var i="";return s?i="giphy":n&&(i="spotify"),Kt({contentSource:i,contentURL:t},r)}}]),t})(k.PureComponent);M()(Xt,"defaultProps",{activityFeedItem:null,deleteMsg:le.a,isActivityFeed:!1,isContactCard:!1,isProfile:!1,isFirstInGroup:!1,isImage:!1,isGif:!1,isSwipeNoteMessage:!1,isContextualMessage:!1,isLeft:!1,isTypingIndicator:!1,isVinylMessage:!1,gender:0,maxWidth:0,message:"",messageState:"",sharedProfile:null,sentDate:"",onClickSharedProfile:le.a,onRenderLinkPreview:le.a,trackChatInteract:le.a,vinylItem:null});var ea=Object(W.c)(Xt),ta=a(1337),aa=a(131),sa=a(93);function na(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function ra(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?na(Object(a),!0).forEach((function(t){M()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):na(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var ia={second:45,minute:45,hour:22,day:5,week:4,month:12},oa=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now(),a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=ra({},ia,{},a),n=(+e-+t)/sa.d;if(Math.abs(n)<s.second)return{value:Math.round(n),unit:"second"};var r=n/60;if(Math.abs(r)<s.minute)return{value:Math.round(r),unit:"minute"};var i=n/3600;if(Math.abs(i)<s.hour)return{value:Math.round(i),unit:"hour"};var o=n/86400;if(Math.abs(o)<s.day)return{value:Math.round(o),unit:"day"};var c=n/604800;if(Math.round(Math.abs(c))>0&&Math.abs(c)<s.week)return{value:Math.round(c),unit:"week"};var d=new Date(e),l=new Date(t),p=d.getFullYear()-l.getFullYear(),u=12*p+(d.getMonth()-l.getMonth());return Math.round(Math.abs(u))>0&&Math.abs(u)<s.month?{value:Math.round(u),unit:"month"}:{value:Math.round(p),unit:"year"}},ca=a(1119),da=a(1130),la=[{key:"isSuperLikedByMe",intlKey:"youMatchedWithUserViaSuperLike"},{key:"isSuperLike",intlKey:"ICU.userMatchedWithYouViaSuperLike"},{key:"isSuperBoostMatch",intlKey:"youMatchedWithUserViaSuperBoostMatch"},{key:"isBoostMatch",intlKey:"youMatchedWithUserViaBoostMatch"},{key:"isFastMatch",intlKey:"youMatchedWithUserViaFastMatch"}],pa=c()(Et.a,{fill:"#fff",className:"Sq(12px)"}),ua=c()("span",{className:"Mstart(4px) Lh($3xs)"},void 0,c()(ae.a,{id:"ReadReceipts.getReadReceipts"})),ha=function(e){var t,a=e.gender,s=e.date,n=e.interestBottom,r=e.interestLeft,i=e.interestRight,o=e.interestTop,d=e.interestZoom,l=e.isBoostMatch,p=e.isFastMatch,u=e.isSuperLike,h=e.isSuperBoostMatch,g=e.matchAvatarUrls,m=e.matchId,f=e.matchName,v=e.shouldShowReadReceipts,b=la.find((function(t){return!!e[t.key]}))||{intlKey:"youMatchedWithUser",key:"default"},y=oa(new Date(s),new Date),I=y.value,O=y.unit;switch(b.key){case"isFastMatch":t=aa.w;break;case"isSuperBoostMatch":t=aa.t;break;case"isBoostMatch":t=aa.g;break;case"isSuperLike":t=aa.u;break;default:t=""}var M=c()("div",{className:Object(A.a)("My(24px)--s My(32px)--ml",{"Mb(32px) Pos(r)":!!t})},void 0,c()(ca.a,{borderStroke:t,className:"M(a)",interestBottom:n,interestLeft:r,interestRight:i,interestTop:o,interestZoom:d,name:f,size:"xl",urls:g},void 0,c()(da.a,{isBoostMatch:l,isFastMatch:p,isSuperLike:u,isSuperBoostMatch:h,badgeProps:{className:"Pos(a) B(0) Start(50%) Translate(-50%,50%)",size:"large"}})));return c()("div",{className:"Ta(c) Animn($anim-bounce-in) Animdur(.9s) Animtf(l) Animfm(f)"},void 0,c()("h3",{className:"Maw(340px)"},void 0,c()(ae.a,{id:b.intlKey,values:{matchName:c()("span",{className:"Fw($bold)"},void 0,f),gender:a}})),c()("div",{},void 0,c()(ta.a,{unit:O,value:I})),c()(Tt.a,{},void 0,M),c()(Tt.c,{},void 0,c()(ue.f,{to:Object(he.c)("messageMatchProfile",{matchId:m}),i13nModel:{label:"ChatNoMessages",message:"View profile"}},void 0,M)),c()("h4",{className:"Maw(340px) Fw($regular)"},void 0,c()(ae.a,{id:"conversationStarter".concat(Math.floor(Math.random()*he.a.numberOfConversationStarters)+1)})),v?c()("button",{className:Object(A.a)(Lt.c,"Bgc($c-blue) Cur(p) Bdrs(16px) CenterAlign Fld(r) Px(16px) Py(4px) C(#fff) Fz($2xs) M(a)"),onClick:function(){e.openModal(Bt.N,{props:{from:Ft.E}})}},void 0,pa,ua):null)};ha.defaultProps={gender:0,interestBottom:1,interestLeft:0,interestRight:1,interestTop:0,interestZoom:!1,isBoostMatch:!1,isFastMatch:!1,isSuperBoostMatch:!1,isSuperLike:!1,isSuperLikedByMe:!1,shouldShowReadReceipts:!1};var ga=Object(k.memo)(ha,(function(){return!0})),ma=a(127),fa=a(126),va=a(254),ba=a(72),ya=a(50),Ia=a(120),Oa=function(e){var t=e.onResize,a=Object(k.useRef)();return Object(k.useEffect)((function(){var e,s=V()(a,["current","contentWindow"]);return s&&(e=Object(N.b)("resize",t,{target:s,eventOptions:{passive:!0}})),function(){s&&e.unsubscribe()}}),[t]),S.a.createElement("iframe",{title:"resize-sensor","aria-hidden":"true",ref:a,style:{height:"100%",width:"100%",border:"none",background:"transparent",position:"absolute",zIndex:-1,top:"0px",left:"0px"}})},Ma=a(9),ka=a(319),Sa=a(1154),xa=a(330),Pa=a(21),Ca=a(456);function Ra(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function ja(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Ra(Object(a),!0).forEach((function(t){M()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Ra(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var wa=(function(){function e(t,a,s){l()(this,e),this.sessionId=null,this.trackEventFn=t,this.sourceSessionId=a,this.dataModel=s||{}}return u()(e,[{key:"start",value:function(e,t){this.sessionId=Object(ma.a)(),this.trackEventFn(It.d,ja({type:"start",sourceSessionId:this.sourceSessionId,source:e,sessionId:this.sessionId,isReadReceiptEnabled:t},this.dataModel))}},{key:"end",value:function(e){this.sessionId&&(this.trackEventFn(It.d,ja({type:"end",source:e,sessionId:this.sessionId},this.dataModel)),this.sessionId=null)}},{key:"track",value:function(e,t,a){this.sessionId&&this.trackEventFn(It.c,ja({type:e,action:t,sessionId:this.sessionId},this.dataModel,{},a))}},{key:"hasActiveSession",get:function(){return!!this.sessionId}}]),e})(),Ea=a(178),Na=function(e){var t=e.className,a=e.pathClassName,s=e.fill,n=e.stroke;return c()(Ea.a,{className:t},void 0,c()("path",{className:a,d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.27 2 8.5 2 5.41 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.08C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.41 22 8.5c0 3.77-3.4 6.86-8.55 11.53L12 21.35z",fill:s,stroke:n,strokeWidth:"1"}))};Na.defaultProps={className:"",fill:aa.f,pathClassName:"",stroke:aa.a},Na.normalized=!0;var Ta=Object(k.memo)(Na),Da=Object(k.memo)((function(e){var t=e.className,a=e.editable,s=e.isLiked,r=e.onClick,o=Object(k.useState)(s),d=i()(o,2),l=d[0],p=d[1],u=a?ue.b:"span",h=a?{i13nModel:{label:"Message",message:l?"unlike message":"like message"}}:{};return S.a.createElement(u,n()({role:"checkbox","aria-checked":l?"true":"false",className:Object(A.a)(t,{"Cur(p)":a}),onClick:a?function(){p(!l),r(!l)}:le.a},h),c()(Ta,{className:"Sq(20px)",fill:l?aa.e:aa.f,stroke:l?aa.e:aa.c}))})),Aa=(function(e){function t(){var e,a;l()(this,t);for(var s=arguments.length,n=new Array(s),r=0;r<s;r++)n[r]=arguments[r];return a=g()(this,(e=f()(t)).call.apply(e,[this].concat(n))),M()(b()(a),"wrapperRef",Object(k.createRef)()),M()(b()(a),"handleClickedLikeMessage",(function(e){a.props.toggleLikeMessage(a.props.message.get("_id"),e)})),M()(b()(a),"renderLikeable",(function(){var e=a.props,t=e.isMe,s=e.message;return c()(Da,{className:Object(A.a)("Pos(a) T(50%) TranslateY(-50%)",{"Start(0)":t,"End(0)":!t}),editable:!t,isLiked:s.get("is_liked"),onClick:t?le.a:a.handleClickedLikeMessage})})),a}return I()(t,e),u()(t,[{key:"render",value:function(){var e=this.props,t=e.emojiOnly,a=e.hasReadReceiptProducts,s=e.interestLeft,n=e.interestTop,r=e.interestRight,i=e.interestBottom,o=e.interestZoom,d=e.isActivityFeed,l=e.isContactCard,p=e.isFirstInGroup,u=e.isGif,h=e.isSwipeNoteMessage,g=e.isReaction,m=e.isContextualMessage,f=e.isContextualLike,v=e.contextualContextMetaData,b=e.isLastInGroup,y=e.isImage,I=e.isMe,O=e.isProfile,M=e.isTypingIndicator,x=e.isTypingIndicatorVisible,P=e.isVinylMessage,C=e.isMessageRead,R=e.isReadReceiptLoading,j=e.lastReadMessageTimeStamp,w=e.matchAvatarUrls,E=e.gender,N=e.matchId,B=e.matchName,L=e.message,_=e.messageState,F=e.msgLeftMaxWidth,$=e.msgRightMaxWidth,U=e.onClickSharedProfile,z=e.onDeleteMessage,V=e.onSendMessageRetry,W=e.otherId,G=e.consumeReadReceipt,q=e.clearReadReceiptError,H=e.readReceiptError,J=e.readReceiptsRemaining,Y=e.showAvatar,Z=e.showDateDivider,K=e.shouldShowReadReceipt,Q=e.dateDividerDate,X=e.trackEvent,ee=!f&&!g,te=!(h||g||m||f);return c()(k.Fragment,{},void 0,S.a.createElement("div",{className:Object(A.a)("msgWrp Pos(r) Cur(p)--m",{"Ta(end) Cnt($blank)::a Bgc($c-superlike-blue)::a Pstart(100px)":I,"Ta(start) Pend(90px) Pstart(42px)--s Pstart(62px)":!I,"My(8px)":!p,"Mt(12px) Mb(8px)":p,"msgWrp--failed":_===ge.a,"msgWrp--svgGif":b&&u,"D(f) Ai(fe)":P&&!I,"D(n)!":M&&!x}),onClick:V,ref:this.wrapperRef},ee?c()(k.Fragment,{},void 0,te&&I&&L.get("is_liked")?this.renderLikeable():null,c()(ea,{activityFeedItem:L.get("activity_feed_item"),sharedProfile:L.get("profile"),isFirstInGroup:p,media:L.get("media"),isImage:y,matchName:B,message:L.get("message"),messageId:L.get("_id"),sentDate:L.get("sent_date"),messageObject:L,to:L.get("to"),isGif:u,isSwipeNoteMessage:h,isContextualMessage:m,contextualContextMetaData:v,isActivityFeed:d,isContactCard:l,isProfile:O,isLeft:!I,gender:E,isVinylMessage:P,isMessageRead:C,isReadReceiptLoading:R,consumeReadReceipt:G,clearReadReceiptError:q,hasReadReceiptProducts:a,readReceiptError:H,readReceiptsRemaining:J,shouldShowReadReceipt:K,lastReadMessageTimeStamp:j,maxWidth:I?$:F,messageState:_,deleteMsg:z,isTypingIndicator:M,otherId:W,openModal:this.props.openModal,matchId:N,trackEvent:X,trackChatInteract:this.props.trackChatInteract,onClickSharedProfile:U,vinylItem:L.get("song")})):c()(tt,{isReaction:g,isContextualLike:f,isContextualMessage:!1,isSwipeNote:!1,message:null,contextualContextMetaData:v,isMe:I,gender:E,matchName:B}),c()(k.Fragment,{},void 0,I||M||!te?null:this.renderLikeable(),c()(T.a,{component:null},void 0,Y&&c()(D.a,{classNames:"chat-avatar-animation",timeout:{enter:1,exit:250}},"avatar",c()(ca.a,{className:Object(A.a)("chatAvatar","D(ib) Va(m) Sq(50px)--ml Sq(34px)--s","Pos(a)! B(0) Start(0) ","Trsp($transform) Trsdu($fast)",{"TranslateY(-50%)--s":t}),interestLeft:s,interestTop:n,interestRight:r,interestBottom:i,interestZoom:o,name:B,urls:w}))))),Z&&c()(ie,{date:Q},"dateDivider-".concat(Q)))}}]),t})(k.PureComponent);M()(Aa,"defaultProps",{contextualContextMetaData:{},dateDividerDate:null,emojiOnly:!1,gender:0,hasReadReceiptProducts:!1,interestBottom:1,interestLeft:0,interestRight:1,interestTop:0,interestZoom:!1,isActivityFeed:!1,isContactCard:!1,isFirstInGroup:!1,isGif:!1,isMessageRead:!1,isSwipeNoteMessage:!1,isReaction:!1,isContextualMessage:!1,isContextualLike:!1,isLastInGroup:!1,isProfile:!1,isTypingIndicator:!1,isTypingIndicatorVisible:!1,isVinylMessage:!1,matchName:"",message:_e.b,messageState:"",msgLeftMaxWidth:0,msgRightMaxWidth:0,lastReadMessageTimeStamp:0,onClickSharedProfile:le.a,onDeleteMessage:le.a,onSendMessageRetry:le.a,readReceiptsRemaining:0,showAvatar:!1,showDateDivider:!1,shouldShowReadReceipt:!1,trackChatInteract:le.a});var Ba=Aa,La=a(1321),_a=a(1125),Fa=a(448),$a=a.p+"7368cf35026fef1a5c193e7db894f7d6.svg",Ua=a.p+"ad496c1ead726f398817f79203976d27.svg",za={className:Object(A.a)("Py(14px)--m Py(20px)--l Cf--s","BdB Bdc($c-divider)","Ta(c) W(100%) Bgc(#fff)","D(f)--ml Ai(c)--ml Jc(sb)--ml Px(24px)--ml"),i13nModel:{label:"ChatNavBar"}},Va=c()(La.a,{className:"Va(m) Mstart(4px)",type:"verified"}),Wa=c()(ae.a,{id:"unmatch"}),Ga=c()("span",{className:"Hidden"},void 0,c()(ae.a,{id:"options"})),qa=c()("span",{className:"Hidden"},void 0,c()(ae.a,{id:"back"})),Ha=c()(_a.a,{}),Ja=c()("span",{className:"Hidden"},void 0,c()(ae.a,{id:"back"})),Ya=Object(k.memo)((function(e){var t=e.date,a=e.handleOpenOptions,s=e.interestBottom,n=e.interestLeft,r=e.interestRight,i=e.interestTop,o=e.interestZoom,d=e.isBoostMatch,l=e.isSuperBoostMatch,p=e.isFastMatch,u=e.isSuperLike,h=e.isSuperLikedByMe,g=e.isVerified,m=e.matchAvatarUrls,f=e.matchId,v=e.matchName,b=e.onBackClick,y=e.prevPath,I=function(e){e.preventDefault(),a()},O=y&&Object(he.d)(y)===Object(he.c)("likesYou")?Object(he.c)("likesYou"):Object(he.c)("matches"),M=c()(ca.a,{className:Object(A.a)("D(ib) Va(m) Fxs(0) M(0) Bd Bdw(3px) Bdc(#fff) Bgc(#fff)","Sq(34px)--s Sq(50px)--ml","Bxsh($bxsh-circle-btn)--ml"),interestLeft:n,interestTop:i,interestRight:r,interestBottom:s,interestZoom:o,loader:fe.d.NONE,name:v,urls:m}),x=c()(re,{className:"chatNavBar__connectionInfo Pstart(24px) Fw($medium) C($c-pink)--m:h Trsdu($normal) Trsp($color) Ta(start)--ml C($c-secondary) C($c-pink)--m",size:"Fz($ms)",date:t,isBoostMatch:d,isSuperBoostMatch:l,isFastMatch:p,isSuperLike:u,isSuperLikedByMe:h,matchName:v}),P=c()(k.Fragment,{},void 0,c()(Tt.c,{},void 0,c()(ue.i,{to:Object(he.c)("messageMatchProfile",{matchId:f}),className:Object(A.a)("D(ib)--s D(f) Ai(c) Fxg(1) Py(4px)","Cur(p)",Lt.b),i13nModel:{message:"Match profile"}},void 0,M,c()(Tt.b,{},void 0,c()("span",{className:"Mstart(10px) Va(m)"},void 0,v,g&&Va)),c()(Tt.d,{},void 0,x))),c()(Tt.a,{},void 0,c()("div",{className:"D(ib)--s D(f) Ai(c) Fxg(1) Py(4px)"},void 0,M,x)),c()(Tt.d,{},void 0,c()("div",{className:"Mend(16px)"},void 0,c()(Fa.a,{theme:"outline",onClick:I,i13nModel:{message:"Unmatch"}},void 0,Wa))),c()(Tt.b,{},void 0,c()(ue.b,{className:Object(A.a)("Fl(end) Bgp(c) Bgr(nr) Sq(44px) Fxs(0)",Lt.b),onClick:I,i13nModel:{message:"Click options"},style:{backgroundImage:"url(".concat($a,")")}},void 0,Ga)),c()(Tt.b,{},void 0,c()(ue.i,{onClick:b,i13nModel:{message:"Back to previous"},to:O,className:Object(A.a)("Fxs(0) Fl(start) Cur(p) Bgp(c) Bgr(nr) Sq(44px)",Lt.b),style:{backgroundImage:"url(".concat(Ua,")")}},void 0,qa)),c()(Tt.e,{},void 0,c()(ue.i,{onClick:b,i13nModel:{message:"Back to match"},to:Object(he.c)("matches"),tabIndex:"-1"},void 0,Ha,Ja)));return c()(k.Fragment,{},void 0,c()(Tt.b,{},void 0,S.a.createElement(ue.g,za,P)),c()(Tt.e,{},void 0,S.a.createElement(ue.d,za,P)))})),Za=a(1262),Ka=a(1168),Qa=a(1169),Xa=a(41),es=a(1263),ts=a(1300),as=a(460),ss=a(1207),ns=a(1208),rs={setEndReached:as.a},is=Object(E.c)(null,rs,null,{forwardRef:!0})(Object(ns.a)(ss.a)),os=Object(k.memo)((function(e){var t=e.activeAppId,a=e.activeTooltip,s=e.apps,n=e.onDismissTooltip,r=e.onTooltipShown,i=e.toggleDrawer,o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"dismiss";n(a,e)},d=function(){o("tap tooltip")},l=function(){r(a)},p=function(e,t){a&&o(),i(e,t)};return c()("div",{className:Object(A.a)("Pos(r) Bgc(#fff) Pstart(10px)",e.className)},void 0,s.map((function(e,s){var n=e.trigger,r=e.tooltip,i=t===e.id;return c()(k.Fragment,{},s,a===e.id&&r?c()(r,{onTooltipTap:d,onTooltipShown:l}):null,c()("div",{className:"Cur(p) W(40px)"},void 0,c()(n,{toggleDrawer:p,isActive:i,className:Object(A.a)("P(0) Cur(p)")})))})))})),cs=a(436),ds=a(78),ls=a.n(ds),ps=function(e){var t=e.className,a=e.isActive,s=ls()(e,["className","isActive"]),r=a?"#32aeff":"#ebeff2",i=a?"#ebeff2":"#32aeff";return S.a.createElement(Ea.a,n()({className:t},s),c()("g",{transform:"translate(2 2)",fillRule:"nonzero",fill:"none"},void 0,c()("circle",{fill:r,cx:"10",cy:"10",r:"10"}),c()("path",{d:"M6.844 13c.97 0 1.73-.434 2.275-1.094V9.683H6.57v1.077h1.41v.694c-.216.217-.665.443-1.137.443-.97 0-1.674-.807-1.674-1.901 0-1.094.704-1.902 1.674-1.902.569 0 1.025.347 1.265.755l.946-.555C8.655 7.608 7.957 7 6.844 7 5.282 7 4 8.164 4 9.996 4 11.819 5.282 13 6.844 13zm4.318-.113V7.096h-1.138v5.791h1.138zm2.194 0v-2.396h2.588V9.405h-2.588V8.181H16V7.096h-3.781v5.791h1.137z",fill:i})))};ps.defaultProps={isActive:!1},ps.normalized=!0;var us=Object(k.memo)(ps),hs={openGif:Sa.c},gs=Object(E.c)(null,hs)(Object(k.memo)((function(e){var t=e.className,a=e.toggleDrawer,s=e.openGif,n=e.isActive,r=Object(cs.a)(),i=Object(k.useCallback)((function(){a(ws,bn.above),s()}),[]);return c()("button",{onClick:i,className:Object(A.a)(t,Lt.b)},void 0,c()(us,{alt:r.formatMessage({id:"giphy"}),className:"My(6px) Sq(40px)",isActive:n}))}))),ms=a(253),fs=a(83),vs=a(454),bs=a(1174),ys=a(1313),Is=Object(be.handleViewport)((function(e){var t=e.index,a=e.forwardedRef,s=e.item,n=e.renderItem;return S.a.createElement("div",{ref:a,key:t},n(s,t))}),{},{disconnectOnLeave:!0}),Os=c()("span",{className:"Mstart(4px) Mend(12px) As(c) H(20px) Bdc($c-secondary) BdEnd"}),Ms=c()("div",{className:"W(100%) Ta(c) Lh(180px)--ml Lh(100px)"},void 0,c()(At.a,{color:"#ff4848"})),ks=c()(bs.a,{className:"D(i) C($c-pink)",fill:""}),Ss=Object(k.memo)((function(e){var t=e.errorString,a=e.onEnterViewport,s=e.renderItem,n=e.results,r=e.supplementalResults,o=Object(cs.a)(),d=Object(k.createRef)(),l=Object(k.useState)(!1),p=i()(l,2),u=p[0],h=p[1],g=Object(k.useState)(!0),m=i()(g,2),f=m[0],v=m[1],b=Object(k.useState)(0),y=i()(b,2),I=y[0],O=y[1],M=n&&n.size||r&&r.size,x=!!t,P=Object(k.useCallback)((function(e,t){return function(){a&&a(e,t)}})),C=Object(k.useCallback)((function(){F()((function(){if(d.current){var e=d.current,t=e.scrollLeft+e.clientWidth-20;d.current.scrollLeft=t,O(t)}}))})),R=Object(k.useCallback)((function(){F()((function(){if(d.current){var e=d.current,t=e.scrollLeft-e.clientWidth-20;d.current.scrollLeft=t,O(t)}}))}));Object(k.useEffect)((function(){d.current&&(d.current.scrollLeft=0,O(0))}),[n]),Object(k.useEffect)((function(){if(d.current){var e=d.current,t=e.clientWidth,a=e.scrollWidth;h(I>0),v(I+t<=a-20)}}),[n,I]);return c()("div",{className:"Expand"},void 0,S.a.createElement("div",{ref:d,className:"Expand D(f) Fxg(1) P(10px)--ml P(4px) Ovx(s) Sb(s)"},M||x?null:Ms,M?c()("div",{className:"D(f) Fld(r) Fxs(0) Pend(20px)"},void 0,c()(k.Fragment,{},void 0,n.map((function(e,t){return c()(Is,{item:e,index:t,onEnterViewport:P(e,t),renderItem:s},t)})),r&&c()(k.Fragment,{},void 0,n.size?Os:null,r.map((function(e,t){return c()(Is,{item:e,index:t,onEnterViewport:P(e,t),renderItem:s},t)}))))):null,M&&!x?c()(k.Fragment,{},void 0,c()("div",{className:"TranslateY(-50%) T(50%) Pos(a) Start(10px)"},void 0,u?c()(ys.a,{title:o.formatMessage({id:"back"}),navButtonsTheme:"circle",onClick:R,buttonClassName:"C(#fff)"}):null),c()("div",{className:"TranslateY(-50%) T(50%) Pos(a) End(10px)"},void 0,f?c()(ys.a,{title:o.formatMessage({id:"next"}),navButtonsTheme:"circle",onClick:C,buttonClassName:"Scale(-1) C(#fff)"}):null)):null,x?c()("div",{className:"W(100%) Ta(c) Lh(200px)--ml Lh(100px)"},void 0,ks,c()(ae.a,{id:t},void 0,(function(e){return c()("div",{className:"msg__status D(i) Fz($xs) C($c-red) Pstart(4px)"},void 0,e)}))):null))})),xs=Object(he.e)("webp")?"webp":"url";function Ps(e,t){if(e&&t){var a=Date.now(),s="".concat(e,"&ts=").concat(a,"&user_id=").concat(t);fs.a.addTask((function(){Object(ms.a)(s,{})}))}}var Cs=c()("div",{className:"W(100%) Ta(c) Lh(200px)--ml Lh(100px) Fz($l)--ml"},void 0,c()(ae.a,{id:"NoSearchResults.title"}));var Rs={openGif:Sa.c,trackEvent:Pa.a},js=Object(E.c)((function(e){return{gifs:Object(ka.a)(e),gifsError:Object(ka.b)(e)}}),Rs)(Object(k.memo)((function(e){var t=e.gifs,a=e.isMobile,s=e.onItemEnterViewport,n=e.onResultsLoaded,r=e.onShutdown,i=e.onStartup,o=e.openGif,d=e.query,l=void 0===d?"":d,p=e.sendMessage,u=e.trackEvent,h=Object(cs.a)(),g=a?"fixedHeightSmall":"fixedHeight",m=Object(k.useRef)(Object(ma.a)()),f=Object(k.useRef)(0);Object(k.useEffect)((function(){return i(ws),function(){r(ws,{query:l})}}),[]),Object(k.useEffect)((function(){f.current=Date.now(),o(l)}),[l]);var v=Object(k.useCallback)((function(e,t){var a=e.get("id"),n=e.getIn([g,xs]),r=e.getIn(["analytics","onload","url"]);r&&Ps(r,m.current),s(ws,{query:l,contentId:a,contentURL:n,position:t},{query:l,gifId:a,gifURL:n,position:t})}),[l]),b=Object(k.useCallback)((function(e,t){return function(){var a=e.get("id"),s=e.getIn(["original",xs],""),n=e.getIn(["original","height"],""),r=e.getIn(["original","width"],""),i=e.getIn(["analytics","onsent","url"]);i&&Ps(i,m.current),p({message:"".concat(s,"?width=").concat(r,"&height=").concat(n),type:"gif",gif_id:a,position:t,messageType:1,contentID:a}),u(It.h,{query:l,gifId:a,gifURL:s,position:t})}}),[l]),y=Object(k.useCallback)((function(){var e=f.current||0;e&&(n(ws,{durationInMillis:Date.now()-e,query:l,count:t&&t.size},{query:l,count:t&&t.size,duration:Date.now()-e}),f.current=0)}),[l]);return c()(k.Fragment,{},void 0,l&&l.length&&t&&!t.size?Cs:c()(Ss,{results:t,renderItem:function(e,t){var a=e.getIn([g,"height"]),s=e.getIn([g,"width"]),n=e.getIn(["original",xs],"");return c()(vs.a,{className:Object(A.a)("M(10px)--ml M(4px) Pos(r)","Bdrs(8px) Ov(h) Cur(p) Bdw(1px) Bds(s)","Bdc($c-divider) Bg($c-battleship-gray) Mend(20px)::lc"),onClick:b(e,t)},void 0,c()(Se,{src:Rt(n,".mp4"),onLoaded:y,poster:"webp"===xs?Rt(n,".webp"):n,alt:h.formatMessage({id:"giphy"}),height:a,width:s}))},onEnterViewport:v}))}))),ws="gif",Es={id:ws,drawer:js,trigger:gs,config:{searchPlaceholderId:"SearchAGif"}},Ns=function(e){var t=e.className,a=e.isActive,s=ls()(e,["className","isActive"]),r=a?"#30d667":"#ebeff2",i=a?"#ebeff2":"#30d667";return S.a.createElement(Ea.a,n()({className:t},s),c()("g",{fillRule:"nonzero",fill:"none"},void 0,c()("path",{d:"M12 2C6.477 2 2 6.477 2 12c0 5.524 4.477 10 10 10s10-4.477 10-10S17.523 2 12 2z",fill:r}),c()("path",{d:"M15.183 7.006l-5.835.786a.72.72 0 0 0-.62.716v5.466a2.325 2.325 0 0 0-.944-.104c-1.066.104-1.866.897-1.777 1.75.078.862 1.011 1.472 2.077 1.369 1.067-.104 1.866-.897 1.777-1.76 0-.013 0-.024-.01-.047l.01-4.982c0-.18.13-.331.304-.358l4.286-.65a.354.354 0 0 1 .285.084.364.364 0 0 1 .124.273v3.815a2.325 2.325 0 0 0-.944-.103c-1.067.103-1.866.897-1.777 1.76.077.863 1.01 1.473 2.077 1.37 1.066-.104 1.866-.898 1.777-1.761-.007.007-.007-2.295-.001-6.906a.727.727 0 0 0-.244-.545.708.708 0 0 0-.565-.173z",fill:i})))};Ns.defaultProps={isActive:!1},Ns.normalized=!0;var Ts=Object(k.memo)(Ns),Ds=Object(k.memo)((function(e){var t=e.toggleDrawer,a=e.className,s=e.isActive,n=Object(cs.a)(),r=Object(k.useCallback)((function(){t(Js,bn.above)}),[]);return c()("button",{onClick:r,className:Object(A.a)(a,Lt.b)},void 0,c()(Ts,{alt:n.formatMessage({id:"vinyl"}),className:"Sq(40px) My(6px)",isActive:s}))})),As=a(1264),Bs=a(1265),Ls=a(1147),_s=a(1298);function Fs(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function $s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Fs(Object(a),!0).forEach((function(t){M()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Fs(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var Us={id:"popular_songs",intlId:"Vinyl.PopularSongs"},zs={id:"recently_sent",intlId:"Vinyl.RecentlySent"},Vs={id:"top_results",intlId:"Vinyl.TopResults"},Ws=c()(Ls.a,{className:"Mend(4px) Va(m)",title:"spotify"}),Gs=c()("div",{className:"CenterAlign H(210px) H(112px)--s W(100%) Fld(c)"},void 0,c()("div",{className:"Ta(c) Fz($l)--ml Pt(12px)"},void 0,c()(ae.a,{id:"Vinyl.NoResultsFound"})));var qs={clearSongSearchResponse:Bs.a,fetchPopularSongs:Bs.b,searchSong:Bs.e,sendVinyl:Sa.d},Hs=Object(E.c)((function(e){return{searchResults:Object(As.c)(e),songsError:Object(As.b)(e),recentlySent:Object(ka.c)(e),popularSongs:Object(As.a)(e)}}),qs)(Object(k.memo)((function(e){var t,a=e.clearSongSearchResponse,s=e.fetchPopularSongs,n=e.isMobile,r=e.onInteract,o=e.onItemEnterViewport,d=e.onResultsLoaded,l=e.popularSongs,p=e.onShutdown,u=e.onStartup,h=e.query,g=void 0===h?"":h,m=e.recentlySent,f=e.searchResults,v=e.searchSong,b=e.sendMessage,y=e.sendVinyl,I=e.songsError,O=[!g&&m&&m.size&&zs,!g&&Us,g&&Vs].filter((function(e){return e})),M=Object(k.useRef)(),S=Object(k.useRef)(),x=Object(k.useRef)(0),P=Object(k.useState)(g?null:V()(O,[0,"id"])),C=i()(P,2),R=C[0],j=C[1],w=Object(k.useState)(null),E=i()(w,2),N=E[0],T=E[1];g?t=f:"popular_songs"===R?t=l:"recently_sent"===R&&(t=m);var D={query:g,contentSource:"spotify",category:g&&g.length?"search":R,numRecentlySent:m?m.size:0,numResults:t?t.size:0,vinylSessionId:M},B=Object(k.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(ut.Map)(),t=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0,s=e&&e.get("id"),n=e&&e.getIn(["externalUrls","spotify"]);N&&r(Js,jt.p,{contentId:N.get("id"),contentURL:N.getIn(["externalUrls","spotify"]),position:t,activeTab:R},$s({},D,{type:"deselect song",contentId:N.get("id"),contentURL:N.getIn(["externalUrls","spotify"]),position:t,source:a||"other song"})),s&&N!==s&&r(Js,jt.t,{contentId:s,contentURL:n,position:t,activeTab:R},{type:"select song",contentId:s,contentURL:n,position:t}),T((function(t){return t&&t.get("id")===s?null:e}))}),[g]),L=Object(k.useCallback)((function(e,t){var a=e.get("id"),s=e.getIn(["externalUrls","spotify"]);o(Js,{contentId:a,contentURL:s,position:t,query:g,category:g&&g.length?"search":R},$s({},D,{type:"show song",contentId:a,contentURL:s,position:t}))}),[g]),_=function(e,t){var a=e.get("id"),s=e.getIn(["externalUrls","spotify"]);y(e,t),b({message:s,type:"song",track_id:a,position:t,category:g&&g.length?"search":R,messageType:6,contentID:a,contentSource:"spotify",contentURL:s,sendFrom:"vinyl",contentSessionId:M,song:e},$s({},D,{type:"send song",contentId:a,contentURL:s,position:t})),B(null,null,"send song")},F=Object(k.useCallback)((function(){var e=x.current||0,t=Date.now()-e;x.current&&(d(Js,{durationInMillis:t,query:g,count:f?f.size:null,category:g&&g.length?"search":R},$s({},D,{type:"search",durationInMillis:t,success:!I})),x.current=0)}),[g]),$=Object(k.useCallback)((function(e,t){var a=e.get("id"),s=e.getIn(["externalUrls","spotify"]);r(Js,jt.r,{query:g,contentId:a,contentURL:s,position:t,category:g&&g.length?"search":R},$s({},D,{type:"play song",contentId:a,contentURL:s,position:t}))}),[g]),U=Object(k.useCallback)((function(e,t,a){var s=e.get("id"),n=e.getIn(["externalUrls","spotify"]);r(Js,jt.w,{query:g,contentId:s,contentURL:n,position:t,category:g&&g.length?"search":R,durationInMillis:a},$s({},D,{type:"stop song",contentId:s,contentURL:n,position:t,durationInMillis:a}))}),[g]);return Object(k.useEffect)((function(){return M.current=Object(ma.a)(),S.current=Date.now(),u(Js,{},{contentSource:"spotify",vinylSessionId:M,type:"open",source:"input button"}),function(){var e=S.current||0;p(Js,{query:g},{type:"close",durationInMillis:Date.now()-e,vinylSessionId:M,contentSource:"spotify"}),a()}}),[]),Object(k.useEffect)((function(){s(),B(null,null,"search"),x.current=Date.now(),g?(v(g||""),j(null)):j(V()(O,[0,"id"]))}),[g]),c()("div",{className:"Expand"},void 0,c()("div",{className:"D(f) Fld(c) Expand Fxg(1) Ovx(s) Sb(s)"},void 0,c()("div",{className:"W(100%) Fw($semibold) C($c-secondary) Fz($xs)--s Pb(8px)--s Pt(16px) Pt(16px)--s Pstart(20px) Pstart(8px)--s"},void 0,O&&O.map((function(e,t){return c()("button",{className:Object(A.a)("Cur(p) Mend(20px) D(i) P(0)",Lt.b,{"C(#000)":!R&&0===t||R===e.id}),onClick:(a=e.id,function(){B(null,null,"header"),j(a)})},t,"top_results"===e.id&&Ws,c()(ae.a,{id:e.intlId}));var a})))),g&&g.length&&t&&!t.size?Gs:c()(Ss,{results:t,renderItem:function(e,t){var a=e.get("id");return c()(_s.a,{index:t,isMobile:n,onLoaded:F,onSend:_,onSongPlay:$,onSongStop:U,setAsActive:B,isActive:N&&N.get("id")===a,vinylObject:e},a)},onEnterViewport:L}))}))),Js="vinyl",Ys={drawer:Hs,id:Js,trigger:Ds,config:{searchPlaceholderId:"Vinyl.SearchSpotify"}},Zs=c()("path",{d:"M2 12c0 5.524 4.477 10 10 10s10-4.476 10-10c0-5.523-4.477-10-10-10C6.477 2 2 6.477 2 12z"}),Ks=c()("g",{transform:"translate(7.162 9.006)"},void 0,c()("circle",{cx:"1.977",cy:"1.412",r:"1.412"}),c()("path",{d:"M3.953 5.96c0-1.715-.885-3.106-1.976-3.106C.885 2.854 0 4.245 0 5.961"})),Qs=function(e){var t=e.className,a=e.isActive,s=ls()(e,["className","isActive"]),r=a?"#32aeff":"#ebeff2",i=a?"#ebeff2":"#32aeff";return S.a.createElement(Ea.a,n()({className:t},s),c()("g",{fillRule:"nonzero",fill:"none"},void 0,c()("g",{fill:r},void 0,Zs,Ks),c()("path",{d:"M17.218 9.175a3.616 3.616 0 0 0-.487-.032H9.303a3.46 3.46 0 0 0-2.345.896 2.946 2.946 0 0 0-.971 2.164v.156c0 .242.03.479.088.705C5.393 12.536 5 11.756 5 10.934v-.152C5 9.245 6.35 8 8.014 8h6.743c1.016 0 1.915.465 2.461 1.175zm-7.338.551h6.105c1.665 0 3.014 1.245 3.015 2.781v.711C19 14.755 17.65 16 15.986 16H9.881c-1.665 0-3.014-1.246-3.014-2.782v-.71c0-1.537 1.35-2.782 3.014-2.782H9.88zm.22 3.214c.422 0 .764-.322.764-.72 0-.397-.342-.72-.763-.72-.422 0-.763.323-.763.72 0 .398.341.72.763.72zm.025.278c-.719 0-1.17.359-1.354 1.076a.133.133 0 0 0 .028.12c.03.035.074.054.121.054h2.33a.159.159 0 0 0 .117-.05.134.134 0 0 0 .034-.114c-.128-.724-.553-1.086-1.276-1.086zm2.946-1.717c-.294 0-.533.22-.533.492v.015c0 .272.239.492.533.492h3.241c.295 0 .533-.22.533-.492v-.015c0-.272-.238-.492-.533-.492h-3.24zm0 1.5a.557.557 0 0 0-.377.144.474.474 0 0 0-.156.348v.015c0 .13.056.256.156.348.1.093.236.145.377.145h1.087c.295 0 .533-.22.533-.493v-.015c0-.272-.238-.492-.533-.492h-1.087z",fill:i})))};Qs.defaultProps={isActive:!1},Qs.normalized=!0;var Xs=Object(k.memo)(Qs),en=Object(k.memo)((function(e){var t=e.className,a=e.isActive,s=e.toggleDrawer,n=Object(k.useCallback)((function(){s(on,bn.above)}),[]);return c()("button",{onClick:n,className:Object(A.a)(t,Lt.b)},void 0,c()(Xs,{className:"Sq(40px) My(6px)",isActive:a}))})),tn=a(451),an=a.p+"e7bf948703b19ab22351b641860cf787.svg",sn=c()("span",{className:"Mx(4px)"},void 0,"+");var nn={openModal:ya.b},rn=Object(E.c)((function(e){return{populatedCards:Object(Be.jb)(e),unpopulatedCards:Object(Be.Qb)(e),userName:Object(Be.Vb)(e)}}),nn)(Object(k.memo)((function(e){var t=e.openModal,a=e.onPreviewMessage,s=e.populatedCards,n=e.unpopulatedCards,r=e.tracker,i=e.onShutdown,o=e.onStartup,d=Object(cs.a)().formatMessage;Object(k.useEffect)((function(){return o(on,{type:"start",source:"chat"}),function(){i(on,{type:"end",source:"chat"})}}),[i,o]);var l=function(e){return function(){r.track("contact cards","update",{contentSource:e})}},p=function(e){return function(){r.track("contact cards","cancel",{contentSource:e})}},u=function(e,a){var s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return function(n){n&&n.stopPropagation(),s||r.track("contact cards","add",{contentSource:e}),r.track("contact cards","edit",{contentSource:e}),t(Bt.q,{props:{cardType:e,cardId:a,logo:V()(lt,[e,"asset"]),sessionId:r.sessionId,onUpdate:l(e),onCancel:p(e)}})}},h=function(e,t){return function(){r.track("contact cards","preview",{contentSource:e}),a({contactType:e,contactId:t})}};return c()(k.Fragment,{},void 0,c()(Ss,{results:s,supplementalResults:n,renderItem:function(e){var t=e.get("contact_id"),a=e.get("contact_type");return c()("div",{className:Object(A.a)("CenterAlign Py(4px) Px(8px) Bdc($c-divider) Bd Mend(8px) Bdrs(16px) Cur(p)",{"Bgc(#fff)":t,"Bgc($c-divider-lite)":!t},Lt.b),onClick:t?h(a,t):u(a,t),onKeyDown:function(e){Object(tn.a)(e.keyCode)&&(t?h(a,t)():u(a,t)())},"data-cy-type":a,tabIndex:"0"},void 0,c()("img",{className:"Mx(4px) Cur(p)",src:V()(lt,[a,"asset"]),alt:a,loading:"lazy"}),t?null:sn,t||c()(ae.a,{id:a}),t?c()("button",{className:Object(A.a)(Lt.b,"Px(8px) Mend(4px) Py(0) Cur(p)"),onClick:u(a,t,!0)},void 0,c()("img",{src:an,alt:d({id:"edit"})})):null)}}))}))),on="contact_cards",cn={id:on,drawer:rn,trigger:en,message:pt,config:{searchPlaceholderId:"ContactCard.chooseAContactCard",disableInput:!0}};a(1013);function dn(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function ln(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?dn(Object(a),!0).forEach((function(t){M()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):dn(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var pn=[Es,Ys,cn],un=he.a.ui.inputDebounceTime,hn="show",gn="hide",mn="message",fn="expired",vn="left chat",bn={above:"above",below:"below"},yn={is_super_boost_match:"super boost",is_boost_match:"boost",is_super_like:"superlike",is_fast_match:"likes you"},In=c()("div",{className:"msg"}),On=c()("div",{className:"msg"}),Mn=(function(e){function t(){var e,a;l()(this,t);for(var s=arguments.length,n=new Array(s),r=0;r<s;r++)n[r]=arguments[r];return a=g()(this,(e=f()(t)).call.apply(e,[this].concat(n))),M()(b()(a),"state",{currentOpenedRecProfile:null,drawerType:null,isInTheBottom:!1,isTypingIndicatorVisible:!1,lastReceivedMessageId:null,lastSeenMessageId:a.props.lastSeenMessageId,loadMoreState:a.props.loadMoreState,messages:a.props.messages,newReceivedMessages:!1,showProfileRec:!1,drawerIsClosing:!0}),M()(b()(a),"drawerRef",Object(k.createRef)()),M()(b()(a),"numberOfMessagesSent",{contact_card:0,gif:0,song:0,text:0}),M()(b()(a),"getChatApps",w()((function(e){return e?pn:pn.filter((function(e){return e.id!==Js}))}))),M()(b()(a),"newSession",(function(){var e=a.props,t=e.matchId,s=e.toUserId,n=e.match,r=e.prevPath;a.sessionId=Object(ma.a)(),a.sessionStartTime=Date.now();var i=n.getIn(["readreceipt","enabled"],!1);a.dmEventTracker=new wa(a.props.trackEvent,a.sessionId,{matchId:t,isReadReceiptEnabled:i}),a.props.startChatSession(a.sessionId,t),a.props.trackEvent(It.b,{type:jt.m,otherId:s,chatSessionId:a.sessionId,matchId:t,bullseyeAdjusted:n.getIn(["person","photos",0,"crop_info","processed_by_bullseye"],!1),isReadReceiptEnabled:i,createdDate:n.get("created_date"),attribution:a.attribution,previousPath:r})})),M()(b()(a),"endSession",(function(e,t,s){a.props.trackEvent(It.b,{type:jt.j,otherId:s,matchId:e,durationInMillis:Date.now()-a.sessionStartTime,currentPath:a.props.currentPath,attribution:a.attribution,origin:1}),a.dmEventTracker.end(jt.x),a.props.endChatSession(e),a.sessionStartTime=null})),M()(b()(a),"unseenMessages",[]),M()(b()(a),"subscription",null),M()(b()(a),"throttledUpdateLastSeenMessageId",U()((function(){a.updateLastSeenMessageId()}),un)),M()(b()(a),"debouncedSendLastSeenMessageId",P()((function(e,t,s,n){a.props.setLastSeenMatchMessage(e,t,s,n)}),un)),M()(b()(a),"getSendMessageRetryFnc",(function(e){return function(){e.get("state")===ge.a&&(a.trackChatInteract(jt.k,jt.e,{source:"chat",messageId:e.get("_id")}),a.props.sendMessageRetry(e.toJS()))}})),M()(b()(a),"deleteMessage",(function(e){e.get("state")===ge.a&&a.props.deleteTempMessage(e.get("match_id"),e.get("_id"))})),M()(b()(a),"setRef",(function(e){a.chatMessages=e?e.getDOMNode():null})),M()(b()(a),"scrollToBottom",(function(){F()((function(){a.chatMessages&&(a.chatMessages.scrollTop=a.chatMessages.scrollHeight)}))})),M()(b()(a),"handleResize",(function(){a.state.isInTheBottom&&a.scrollToBottom()})),M()(b()(a),"handleScroll",(function(){a.setIsInTheBottom(),a.throttledUpdateLastSeenMessageId()})),M()(b()(a),"handleOpenOptions",(function(){var e=a.props,t=e.match,s=e.matchId,n=e.isGoldEnabled;a.props.openModal(Bt.Z,{props:{matchId:s,modalClassName:"modal-slide-up",userId:t.getIn(["person","_id"]),headerId:"areYouSure",subtitleId:"modals.unmatch.tellUsWhy",source:"chat",isBoostMatch:t.get("is_boost_match"),isSuperBoostMatch:t.get("is_super_boost_match"),isFastMatch:n&&t.get("is_fast_match"),isSuperLike:t.get("is_super_like")}})})),M()(b()(a),"handleClickSharedProfile",(function(e){e&&a.setState({currentOpenedRecProfile:e,showProfileRec:!0})})),M()(b()(a),"handleSharedProfileCardClose",(function(e,t){t!==e.get("activePhotoIndex",0)&&a.props.updateProfileEntityPhoto(e,t),a.setState({showProfileRec:!1})})),M()(b()(a),"handleSharedProfileLike",(function(e,t){a.props.sharedRecLike({recUser:e,method:Ca.recsRateMethods.sharedProfile,reactionsData:{likedContentId:t,likedContentType:"photo"}}),a.setState({showProfileRec:!1})})),M()(b()(a),"handleSharedProfileDislike",(function(e){a.props.sharedRecDislike({recUser:e,method:Ca.recsRateMethods.sharedProfile}),a.setState({showProfileRec:!1})})),M()(b()(a),"handleSharedProfileSuperlike",(function(e){a.props.sharedRecSuperlike({recUser:e,method:Ca.recsRateMethods.sharedProfile}),a.setState({showProfileRec:!1})})),M()(b()(a),"handleNavBarAvatarClick",(function(){a.trackChatInteract(jt.l,jt.c,{source:jt.b})})),M()(b()(a),"handleNavBarBackClick",(function(){a.props.showSurvey&&a.props.showSurvey({from:ee.REVIEW_FROM_MESSAGE})})),M()(b()(a),"handleNoMessagesAvatarClick",(function(){a.trackChatInteract(jt.l,jt.c,{source:jt.a})})),M()(b()(a),"trackChatInteract",(function(e,t){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=a.props,r=n.matchId,i=n.toUserId;a.props.trackEvent(It.a,ln({type:e,subtype:t,matchId:r,otherId:i},s))})),M()(b()(a),"incrementNumberOfMessagesSent",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"text";Object.prototype.hasOwnProperty.call(a.numberOfMessagesSent,e)&&(a.numberOfMessagesSent[e]=a.numberOfMessagesSent[e]+1)})),M()(b()(a),"sendMessage",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=a.props,s=t.matchId,n=t.userId,r=t.match,i=Object(Ia.b)(s,n),o=Math.random().toString();a.incrementNumberOfMessagesSent(e.type||"text"),a.sendTypingPulse.cancel(),a.props.sendMessage(ln({userId:n,otherId:i,tempMessageId:o,matchId:s,match:r,sessionId:a.dmEventTracker.sessionId},e));var c=r.get("messages"),d=Pt(c,i);a.props.trackEvent(pe.N,{otherId:i,matchId:s,message:e.message,numMessagesMe:c.size-d,numMessagesOther:d,messageType:e.messageType,contentID:e.contentID}),"gif"===e.type&&a.props.trackEvent(It.h,{query:e.query,gifId:e.gif_id,gifURL:e.message,position:e.position}),a.setState({inputValue:"",messageComponent:null,messagePreview:null}),a.state.drawerApp&&a.toggleDrawer(null,null,"send")})),M()(b()(a),"getAppById",(function(e){return a.getChatApps(a.props.isSpotifyEnabled).find((function(t){return t.id===e}))})),M()(b()(a),"toggleDrawer",(function(e,t){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"cancel",n={};if(a.state.drawerApp!==e&&e)a.state.drawerApp?n={drawerApp:e,drawerDirection:t,drawerIsClosing:!1}:(a.sendTypingPulse.cancel(),a.setState({inputMode:"search",drawerApp:e,drawerDirection:t,drawerIsClosing:!1,messagePreview:null}));else{var r,i=Ct(a.props.messages);i&&(r=i===a.props.userId?"self":"none"),a.props.trackEvent(pe.O,{buttonType:e,action:"close",lastMessageFrom:r}),a.setState({inputMode:"default",drawerIsClosing:!0,closingReason:s,inputValue:""})}a.setState({drawerIsClosing:!a.state.drawerIsClosing}),setTimeout((function(){a.setState(n)}),235)})),M()(b()(a),"getShouldAddContextualContextWithoutMessages",(function(){var e=a.props,t=e.messages,s=e.match,n=t.first();if(s.get("liked_content",null)){if(n&&"swipe_note"===n.get("type")){var r=t.get(1,null);if(!(r&&"contextual"===r.get("type")))return!0}return Object(Qe.g)(s)}return!1})),M()(b()(a),"renderContextualConnectionsWithoutMessages",(function(){var e=a.props,t=e.match,s=e.matchId,n=e.messages,r=e.toUserId,i=[],o={matchAvatarUrls:Object(Ae.t)(t),matchName:t.getIn(["person","name"]),showDateDivider:!1,trackEvent:a.props.trackEvent,matchId:s,otherId:r,gender:t.getIn(["person","gender"],0)},c=t.get("liked_content");if(Object(Qe.g)(t)){var d=t.get("is_opener"),l=c.get("by_opener",null),p=c.get("by_closer",null);if(l){var u=!!l.get("reaction_id",null);i.push(ln({},o,{isMe:d,showAvatar:!d,contextualContextMetaData:l,isReaction:u,isContextualLike:!u}))}var h=n.first();if(p){var g=!!p.get("reaction_id",null),m=h?h.get("sent_date"):null;i.push(ln({},o,{isMe:!d,showAvatar:d,contextualContextMetaData:p,isReaction:g,isContextualLike:!g,showDateDivider:!!m,dateDividerDate:m}))}}else{var f=Object(Qe.f)(t)?c.get("by_closer",null):c.get("by_opener",null),v=t.getIn(["person","_id"]);if(f){var b=f.get("user_id")!==v;i.push(ln({},o,{isMe:b,showAvatar:!b,contextualContextMetaData:f,isContextualLike:!0}))}}return i.length?i.map((function(e){return S.a.createElement(Ba,e)})):null})),M()(b()(a),"setLeftRef",(function(e){a.helperLeft=e})),M()(b()(a),"setRightRef",(function(e){a.helperRight=e})),M()(b()(a),"handleToolTipDismissed",(function(e,t){})),M()(b()(a),"handleTooltipShown",(function(){})),M()(b()(a),"storeToRedux",P()((function(e){a.props.setText(a.props.matchId,e)}),500)),M()(b()(a),"storeTextToState",P()((function(e){a.setState({inputValue:e})}),500)),M()(b()(a),"handleInputChange",(function(e){a.state.inputMode&&"default"!==a.state.inputMode||(e&&e!==a.state.inputValue&&a.sendTypingPulse(),a.dmEventTracker&&!a.dmEventTracker.hasActiveSession&&a.dmEventTracker.start("chat")),"search"===a.state.inputMode?a.storeTextToState(e):a.storeToRedux(e)})),M()(b()(a),"handleDrawerAnimationEnd",(function(){a.state.drawerIsClosing&&a.setState({drawerApp:null,drawerDirection:null})})),M()(b()(a),"handleInputFocus",(function(){a.dmEventTracker&&(a.dmEventTracker.start("chat"),a.state.drawerApp?a.dmEventTracker.track(a.state.drawerApp,jt.v):a.dmEventTracker.track(a.state.drawerApp,jt.q))})),M()(b()(a),"handleInputBlur",(function(){a.state.drawerApp||(a.dmEventTracker.track(jt.z,jt.o),a.dmEventTracker.end())})),M()(b()(a),"appIdToLegacyTrackingType",(function(e){switch(e){case Js:return It.j;default:return null}})),M()(b()(a),"handleSearch",(function(e,t,s){var n=a.props.matchId;a.dmEventTracker.track(e,jt.s,t),a.props.trackEvent(a.appIdToLegacyTrackingType(e),ln({matchId:n,chatSessionId:a.sessionId},s)),"gif"===e&&a.props.trackEvent(It.e,s)})),M()(b()(a),"handleItemShown",(function(e,t,s){var n=a.props.matchId;a.dmEventTracker.track(e,jt.u,t),a.props.trackEvent(a.appIdToLegacyTrackingType(e),ln({matchId:n,chatSessionId:a.sessionId},s)),"gif"===e&&a.props.trackEvent(It.i,s)})),M()(b()(a),"sendTypingPulse",U()((function(){var e=a.props,t=e.userId,s=e.match,n=e.matchId,r=e.toUserId,i=s.get("messages"),o=Pt(i,r),c={matchId:n,otherId:r,type:"send",numMessagesMe:i.size-o,numMessagesOther:o,lastMessageUserId:Ct(i)};a.props.sendTypingPulse(n,r,t,Date.now(),c)}),a.props.typingPulseInterval,{trailing:!1})),M()(b()(a),"handleAppStartup",(function(e,t,s){var n=a.props.matchId;a.dmEventTracker.hasActiveSessiion&&a.dmEventTracker.end(),a.dmEventTracker.start("chat"),a.dmEventTracker.track(e,jt.q),s&&a.props.trackEvent(a.appIdToLegacyTrackingType(e),ln({matchId:n,chatSessionId:a.sessionId},s))})),M()(b()(a),"handleAppShutdown",(function(e,t,s){var n=t.query,r=a.props.matchId;a.dmEventTracker.track(e,jt.o,{query:n}),a.dmEventTracker.end(),e===Js&&(a.props.trackEvent(It.l,ln({},s,{endResult:a.state.closingReason})),a.props.trackEvent(It.j,ln({chatSessionId:a.sessionId,matchId:r},s))),e===ws&&a.props.trackEvent(It.f)})),M()(b()(a),"handleDrawerAppInteract",(function(e,t,s,n){var r=a.props.matchId;a.dmEventTracker.track(e,t,s),n&&a.props.trackEvent(a.appIdToLegacyTrackingType(e),ln({matchId:r,chatSessionId:a.sessionId},n))})),M()(b()(a),"handlePreviewMessage",(function(e){var t=a.getAppById(a.state.drawerApp);a.toggleDrawer(),a.setState({messagePreview:e,messageComponent:t.message}),a.toggleDrawer(null,null,"send")})),M()(b()(a),"renderChatActionBar",(function(){return c()(os,{apps:a.getChatApps(a.props.isSpotifyEnabled),toggleDrawer:a.toggleDrawer,onDismissTooltip:a.handleToolTipDismissed,onTooltipShown:a.handleTooltipShown,activeTooltip:a.activeTooltip,activeAppId:!a.state.drawerIsClosing&&a.state.drawerApp,className:Object(A.a)({"BdT Bdtc($c-divider) D(f) W(100%) Ai(c) Jc(fs)":a.shouldRenderStandaloneChatActionBar,"As(c) CenterAlign":!a.shouldRenderStandaloneChatActionBar})})})),M()(b()(a),"renderDrawerApp",(function(){var e=a.getAppById(a.state.drawerApp).drawer;return c()("div",{onAnimationEnd:a.handleDrawerAnimationEnd,className:Object(A.a)("gif__messages Pos(a) D(f) Bgc(#fff) W(100%) BdY Bdc($c-divider) Animdur($normal) Animn($anim-slide-in-up)",{"Animn($anim-slide-out-down)":a.state.drawerIsClosing,"B(105px) B(124px)--ml":a.shouldRenderStandaloneChatActionBar,"B(52px) B(72px)--ml":!a.shouldRenderStandaloneChatActionBar})},void 0,c()(e,{onStartup:a.handleAppStartup,onShutdown:a.handleAppShutdown,onItemEnterViewport:a.handleItemShown,onResultsLoaded:a.handleSearch,query:a.state.inputValue,tracker:a.dmEventTracker,sendMessage:a.sendMessage,onInteract:a.handleDrawerAppInteract,isMobile:a.props.isMobileLayout,onPreviewMessage:a.handlePreviewMessage}))})),M()(b()(a),"handleRemovePreview",(function(){a.dmEventTracker.track("contact cards","close",{source:"preview"}),a.setState({messagePreview:null})})),M()(b()(a),"renderChatInput",(function(){var e=a.getAppById(a.state.drawerApp),t=V()(e,["config","searchPlaceholderId"])||"ChatMessage.type",s=a.props.intl.formatMessage({id:t});return c()(ts.a,{activeAppId:a.state.drawerApp,showCloseButton:a.shouldRenderStandaloneChatActionBar&&e&&!a.state.drawerIsClosing,toggleDrawer:a.toggleDrawer,onFocus:a.handleInputFocus,onBlur:a.handleInputBlur,mode:a.state.inputMode,searchPlaceholder:s,shouldDisableInput:V()(e,["config","disableInput"]),onChange:a.handleInputChange,sendMessage:a.sendMessage,defaultValue:a.props.storedMessage,isMobile:a.props.isMobileLayout,messagePreview:a.state.messagePreview,messageComponent:a.state.messageComponent,onRemovePreview:a.handleRemovePreview})})),a}return I()(t,e),u()(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.match,a=e.matchId,s=e.messages,n=e.toUserId;t&&(this.subscription=Object(N.b)("scroll",this.handleScroll,{target:this.chatMessages,eventOptions:{passive:!0}}),t.getIn(["seen","match_seen"])||this.props.setMatchSeen(a),s.size>0&&(this.scrollToBottom(),this.updateLastSeenMessageId()),this.props.trackEvent(pe.K,{otherId:n,matchId:a,didSuperLike:t.get("is_super_like"),superLike:Boolean(t.get("super_liker"))&&t.get("super_liker")!==n,origin:1}),this.lastScrollHeight=this.chatMessages.scrollHeight,this.newSession())}},{key:"componentDidUpdate",value:function(e,t){var a=this.props,s=a.matchId,n=a.toUserId,r=a.loadMoreState,i=a.messages,o=this.state,c=o.newReceivedMessages,d=o.isTypingIndicatorVisible,l=!t.isTypingIndicatorVisible&&d&&i.size>0,p=e.loadMoreState!==va.d.LOADED&&r===va.d.LOADED,u=Ct(i),h=(function(e,t){return t.messages.size>0&&(0!==e.messages.size&&e.messages.last().get("timestamp")<t.messages.last().get("timestamp"))})(e,this.props)&&u!==n;if((c||l)&&this.state.isInTheBottom||h?this.scrollToBottom():(c||h)&&this.updateLastSeenMessageId(),(function(e,t){return e.messages.size!==t.messages.size||e.loadMoreElement!==t.loadMoreElement})(e,this.props)){var g=this.chatMessages;this.lastScrollHeight!==g.scrollHeight&&(g.scrollTop+=g.scrollHeight-this.lastScrollHeight,this.lastScrollHeight=g.scrollHeight)}var m=t.isTypingIndicatorVisible&&!d,f=Pt(i,n);l||d&&p?(this.typingIndicatorShownStart=Date.now(),this.props.trackEvent(pe.Q,{type:hn,matchId:s,otherId:n}),this.trackChatInteract(jt.n,hn)):m&&(this.props.trackEvent(pe.Q,{type:gn,reason:c?mn:fn,matchId:s,otherId:n,lastMessageUserId:u,numMessagesMe:i.size-f,numMessagesOther:f,durationInMillis:Date.now()-this.typingIndicatorShownStart}),this.trackChatInteract(jt.n,gn,{reason:c?mn:fn})),s!==e.matchId&&(this.endSession(e.matchId,e.match,e.toUserId),this.newSession())}},{key:"componentWillUnmount",value:function(){var e=this;this.subscription&&(this.subscription.unsubscribe(),this.subscription=null),this.throttledUpdateLastSeenMessageId.flush(),this.debouncedSendLastSeenMessageId.flush();var t=this.props,a=t.match,s=t.matchId,n=t.toUserId,r=t.messages;if(this.state.isTypingIndicatorVisible){var o=Ct(r),c=Pt(r,n);this.props.trackEvent(pe.Q,{type:gn,reason:vn,matchId:s,otherId:n,lastMessageUserId:o,numMessagesMe:r.size-c,numMessagesOther:c,durationInMillis:Date.now()-this.typingIndicatorShownStart}),this.trackChatInteract(jt.n,gn,{lastMessageUserId:o,numMessagesMe:r.size-c,numMessagesOther:c,durationInMillis:Date.now()-this.typingIndicatorShownStart})}Object.entries(this.numberOfMessagesSent).forEach((function(t){var a=i()(t,2),s=a[0],n=a[1];n&&e.context.i13n.executeEvent(Ma.R,{category:Ma.E,action:Ma.r,label:"Chat",message:"Submit message - ".concat(s),value:n})})),this.endSession(s,a,n)}},{key:"updateLastSeenMessageId",value:function(){var e=this.props,t=e.matchId,a=e.toUserId;if(this.unseenMessages.length&&this.chatMessages){var s,n,r=this.chatMessages,i=r.scrollTop+r.clientHeight;this.unseenMessages.find((function(e){var t=e.current;V()(t,["wrapperRef","current"])&&(t.wrapperRef.current.offsetTop<i&&(s=t.props.message.get("_id"),n=t.props.message.get("from")));return!1})),s&&(this.setState({lastSeenMessageId:s}),this.debouncedSendLastSeenMessageId(t,s,n,a))}}},{key:"setIsInTheBottom",value:function(e){if(this.chatMessages){var t=this.chatMessages,a=t.scrollHeight,s=t.scrollTop,n=t.clientHeight,r=e||a-s===n;this.state.isInTheBottom!==r&&this.setState({isInTheBottom:r})}}},{key:"renderMessages",value:function(){var e=this,t=this.props,a=t.hasReadReceiptProducts,s=t.isConsumablesEnabled,n=t.match,r=t.matchId,i=t.messages,o=t.loadMoreElement,d=t.readReceiptError,l=t.readReceiptsRemaining,p=t.toUserId,u=t.showTypingIndicator,h=t.isReadReceiptLoading,g=this.state.lastSeenMessageId,m=g?i.findIndex((function(e){return e.get("_id")===g})):-1,f=this.getShouldAddContextualContextWithoutMessages(),v=i.size,b=Object(Ae.t)(n),y=n.getIn(["person","name"]),I=n.getIn(["person","_id"]),O=n.getIn(["person","photos",0]),M=n.getIn(["readreceipt","enabled"],!1),x=n.getIn(["readreceipt","last_seen_msg_id"],""),P=n.getIn(["readreceipt","seen_ts"],null),C=n.get("liked_content"),R=!!n.get("is_opener"),j=n.getIn(["person","gender"],0),w=Object(Qe.g)(n),E=O?Object(Le.g)(O):{},N=E.interestLeft,A=E.interestTop,B=E.interestRight,L=E.interestBottom,_=E.userCustomized,F=void 0!==_&&_,$=xt(this.helperLeft),U=xt(this.helperRight),z=i.findLastEntry((function(e){return e.get("from")!==I})),V=z&&z[0],W=V===v-1;return this.unseenMessages.length=0,c()(T.a,{component:null},void 0,o,f?this.renderContextualConnectionsWithoutMessages():null,i.map((function(t,n){var o=i.get(n-1),g=i.get(n+1),O=0===n,E=1===n,T=n===v-1,_=g?(function(e,t){return(t.get("timestamp")-e.get("timestamp"))/1e3/60})(t,g):0,z=t.get("from")!==I,W="swipe_note"===t.get("type"),G="contextual"===t.get("type"),q=g&&"contextual"===g.get("type"),H=f&&O&&G&&!w,J=E&&G,Y=null;C&&(W||H||J)&&(Y=!!R===z?C.get("by_opener",null):C.get("by_closer",null));var Z=g&&(_>15||(W&&O&&!q||H||J)),K=g&&g.get("sent_date"),Q="gif"===t.get("type"),X="activity"===t.get("type"),ee="image"===t.get("type"),te="profile"===t.get("type"),ae="song"===t.get("type"),se="contact_card"===t.get("type"),ne=t.get("message"),re=O||o&&t.get("from")!==o.get("from"),ie=T||g&&t.get("from")!==g.get("from")||Z,oe=(ie||X||te)&&!z&&!(T&&u),ce=V===n,de=t.get("_id"),le=M&&ce,pe=de===x,ue=t.get("state")||(ce?ge.b:void 0),he=ne?ne.trim():"",fe=Object(me.b)(he),ve=n>m&&!z?Object(k.createRef)():void 0;return ve&&e.unseenMessages.push(ve),c()(D.a,{classNames:"chat-message-animation",timeout:{enter:1},enter:!!T,exit:!1},"".concat(de),S.a.createElement(Ba,{emojiOnly:fe,consumeReadReceipt:e.props.consumeReadReceipt,clearReadReceiptError:e.props.clearReadReceiptError,hasReadReceiptProducts:a&&s,interestLeft:N,interestTop:A,interestRight:B,interestBottom:L,interestZoom:F,isContactCard:se,isActivityFeed:X,isProfile:te,isFirstInGroup:re,isImage:ee,isGif:Q,isSwipeNoteMessage:W,isContextualMessage:G,contextualContextMetaData:Y,isLastInGroup:ie,isMe:z,isVinylMessage:ae,isReadReceiptLoading:h,shouldShowReadReceipt:le,isMessageRead:pe,lastReadMessageTimeStamp:P,matchAvatarUrls:b,matchName:y,message:t,messageState:ue,msgLeftMaxWidth:$,msgRightMaxWidth:U,onDeleteMessage:e.deleteMessage,onSendMessageRetry:e.getSendMessageRetryFnc(t),openModal:e.props.openModal,personID:I,gender:j,readReceiptError:d,readReceiptsRemaining:l,showAvatar:oe,showDateDivider:Z,dateDividerDate:K,matchId:r,otherId:p,ref:ve,trackEvent:e.props.trackEvent,trackChatInteract:e.trackChatInteract,onClickSharedProfile:e.handleClickSharedProfile,toggleLikeMessage:e.props.toggleLikeMessage}))})),u&&v>0&&c()(D.a,{classNames:"typing-indicator-animation",timeout:{enter:1,exit:250}},"typing-indicator",c()(Ba,{interestLeft:N,interestTop:A,interestRight:B,interestBottom:L,interestZoom:F,isFirstInGroup:W,isLastInGroup:!0,isMe:!1,isTypingIndicator:!0,isTypingIndicatorVisible:this.state.isTypingIndicatorVisible,matchAvatarUrls:b,matchName:y,showAvatar:!0,showDateDivider:!1},"typing_indicator")))}},{key:"render",value:function(){var e=this.props,t=e.match,a=e.matchId,s=e.messages,r=e.prevPath,i=e.loadMoreState,o=e.intl,d=e.isGoldEnabled,l=e.hasReadReceiptProducts,p=e.isConsumablesEnabled,u=e.readReceiptsRemaining,h=this.state.showProfileRec;if(!t)return null;var g=s.size,m=t.getIn(["person","name"]),f=t.getIn(["person","_id"]),v=t.getIn(["person","gender"],0),b=t.getIn(["person","photos",0]),y=this.getShouldAddContextualContextWithoutMessages(),I=Object(Qe.g)(t)||Object(Qe.h)(t),O=Object(Le.g)(b),M=O.interestLeft,x=O.interestTop,P=O.interestRight,C=O.interestBottom,R=O.userCustomized,j=void 0!==R&&R,w=I?null:{isBoostMatch:t.get("is_boost_match"),isSuperBoostMatch:t.get("is_super_boost_match"),isFastMatch:d&&t.get("is_fast_match"),isSuperLike:t.get("is_super_like"),isSuperLikedByMe:t.get("super_liker")&&t.get("super_liker")!==f};return c()(ue.d,{className:Object(A.a)("chat Pos(a)--s Bgc(#fff) Pos(r) T(0) Expand D(f) Flx($flx1) Fld(c) Ovs(touch)",{"Jc(c) Ai(c) Ov(h)":0===g}),i13nModel:{category:Ma.E}},void 0,c()(Oa,{onResize:this.handleResize}),S.a.createElement(Ya,n()({gender:v,date:t.get("created_date"),handleOpenOptions:this.handleOpenOptions,onAvatarClick:this.handleNavBarAvatarClick,onBackClick:this.handleNavBarBackClick,interestBottom:C,interestLeft:M,interestRight:P,interestTop:x,interestZoom:j,isVerified:Object(H.d)(t.get("person")),matchAvatarUrls:Object(Ae.t)(t)},w,{matchId:a,matchName:m,openModal:this.props.openModal,personID:f,prevPath:r})),S.a.createElement(is,{className:Object(A.a)("Flx($flx2) Pos(r) Ovy(s) Py(10px) W(100%) Ovx(h) Px(8px) Px(16px)--m Px(20px)--l",{"Sb(s)":this.state.isInTheBottom&&i!==va.d.LOADING}),id:Pn(a),ref:this.setRef,reversed:!0,"aria-label":o.formatMessage({id:"conversationHistory"}),"aria-live":"polite",role:"log"},0===g&&c()(k.Fragment,{},void 0,y?this.renderContextualConnectionsWithoutMessages():c()("div",{className:"CenterAlign Mih(100%) W(100%)"},void 0,S.a.createElement(ga,n()({date:t.get("created_date"),interestBottom:C,interestLeft:M,interestRight:P,interestTop:x,interestZoom:j},w,{gender:v,matchAvatarUrls:Object(Ae.k)(t),matchName:m,matchId:a,openModal:this.props.openModal,onAvatarClick:this.handleNoMessagesAvatarClick,shouldShowReadReceipts:!u&&l&&p})))),(g>0||y)&&c()(Tt.b,{},void 0,S.a.createElement(re,n()({className:"Ta(c)",gender:v,date:t.get("created_date"),matchName:m},w))),g>0&&S.a.createElement("div",{className:"V(h) M(-1px) H(1px) Pstart(100px) Mx(8px) Mx(16px)--m Mx(20px)--l",ref:this.setRightRef},In),g>0&&S.a.createElement("div",{className:"V(h) H(1px) M(-1px) Pend(100px) Pstart(42px)--s Pstart(62px) Mx(8px) Mx(16px)--m Mx(20px)--l",ref:this.setLeftRef},On),g>0&&this.renderMessages()),this.state.drawerDirection===bn.above&&this.state.drawerApp&&this.renderDrawerApp(),c()("div",{className:"D(f) W(100%) BdT Bdtc($c-divider) Bgc(#fff) Pos(r)"},void 0,!this.shouldRenderStandaloneChatActionBar&&this.renderChatActionBar(),this.renderChatInput()),this.shouldRenderStandaloneChatActionBar&&this.renderChatActionBar(),h?c()(Za.a,{currentOpenedRecProfile:this.state.currentOpenedRecProfile,onProfileCardClose:this.handleSharedProfileCardClose,onLike:this.handleSharedProfileLike,onDislike:this.handleSharedProfileDislike,onSuperlike:this.handleSharedProfileSuperlike,backLinkUrl:Object(he.c)("messageMatch",{matchId:this.props.matchId})}):null)}},{key:"attribution",get:function(){var e,t=this.props.match;return Object.keys(yn).some((function(a){var s=t.get(a);return s&&(e=yn[a]),s})),e}},{key:"shouldRenderStandaloneChatActionBar",get:function(){return this.props.isMobileLayout}},{key:"activeTooltip",get:function(){return null}}],[{key:"getDerivedStateFromProps",value:function(e,t){var a=e.loadMoreState,s=e.messages,n=e.toUserId,r=s&&(function(e,t){if(e.size>0){var a=e.findLast((function(e){return e.get("from")===t}));return a&&a.get("_id")}return null})(s,n),i=t.lastReceivedMessageId!==r;return{messages:s,newReceivedMessages:i,lastReceivedMessageId:r,isTypingIndicatorVisible:e.showTypingIndicator&&!i,loadMoreState:a}}}]),t})(k.PureComponent);M()(Mn,"contextTypes",{i13n:L.a.shape({executeEvent:L.a.func})}),M()(Mn,"defaultProps",{isSpotifyEnabled:!0,lastSeenMessageId:null,loadMoreElement:null,loadMoreState:va.d.IDLE,matchId:"",prevPath:"",readReceiptError:"",showTypingIndicator:!1});var kn={clearReadReceiptError:Xa.c,consumeReadReceipt:Xa.f,deleteTempMessage:xa.a,endChatSession:Q,openGif:Sa.c,openModal:ya.b,sendMessage:xa.c,sendMessageRetry:xa.e,sendTypingPulse:xa.g,setLastSeenMatchMessage:xa.h,setMatchSeen:xa.i,setText:Sa.e,sharedRecDislike:xa.j,sharedRecLike:xa.k,sharedRecSuperlike:xa.l,showSurvey:X.e,startChatSession:K,toggleLikeMessage:xa.m,trackEvent:Pa.a,updateProfileEntityPhoto:es.b},Sn=M()({},q.g,"isSpotifyEnabled"),xn=R()([Object(G.a)(Sn),Object(E.c)((function(e,t){var a=t.matchId,s=Object(De.g)(e)(a),n=Object(De.i)(e)(a),r=Object(fa.d)(e),i=Object(Be.pb)(e);return{match:s,matchId:a,messages:n,prevPath:r,toUserId:Object(Ia.b)(a,i),currentPath:Object(fa.a)(e),hasReadReceiptProducts:Object(Be.G)(e),isMobileLayout:Object(ba.k)(e),isGoldEnabled:Object(ba.i)(e),isReadReceiptLoading:Object(Be.X)(e),isConsumablesEnabled:Object(ba.f)(e),readReceiptError:Object(Be.vb)(e),readReceiptsRemaining:Object(Be.yb)(e),showTypingIndicator:s&&s.get("showTypingIndicator"),userId:i,typingPulseInterval:Object(ba.w)(e),storedMessage:Object(ka.d)(e)(a)}}),kn)])(Object(W.c)(Mn)),Pn=function(e){return"".concat("SC.chat_").concat(e)};t.default=Object(Qa.a)(xn,{scrollId:function(e){return Pn(e.matchId)},loadMoreId:function(e){return Object(Ae.i)(e.matchId)},loadMoreAction:J.c,loadMoreElementFnc:function(e,t){return c()(Ka.a,{loadMoreState:e,handleRetry:t,flameLoader:!0},"chatPaginationIndicator")}})}}]);